(this.webpackJsonpkapri_analytics=this.webpackJsonpkapri_analytics||[]).push([[0],{192:function(t,e,n){},347:function(t,e,n){"use strict";n.r(e);var r=n(6),a=n(0),i=n.n(a),c=n(31),o=n.n(c),s=(n(192),n(170)),l=n(171),u=n(185),d=n(182),f=n(26),b=n(27),m=n(71),j=n(36),p=n.n(j),O=n(64),h=n(23),x=n(349),y="YYYY-MM-DD HH:mm:ss",S={girls:["\u0410\u043a\u0441\u0435\u0441\u0441\u0443\u0430\u0440\u044b","\u0411\u043e\u0434\u0438 (\u0434\u043b\u0438\u043d\u043d\u044b\u0439 \u0440\u0443\u043a\u0430\u0432)","\u0411\u043e\u0434\u0438 (\u043a\u043e\u0440\u043e\u0442\u043a\u0438\u0439 \u0440\u0443\u043a\u0430\u0432)","\u041a\u043e\u0444\u0442\u044b","\u041d\u0430\u0431\u043e\u0440\u044b","\u041d\u043e\u0441\u043e\u0447\u043a\u0438","\u041f\u0435\u0441\u043e\u0447\u043d\u0438\u043a","\u041a\u043e\u043b\u0433\u043e\u0442\u043a\u0438","\u041f\u043e\u043b\u0437\u0443\u043d\u043a\u0438","\u041f\u0438\u0436\u0430\u043c\u044b","\u041f\u043b\u0430\u0442\u044c\u044f","\u0420\u0435\u0433\u043b\u0430\u043d\u044b","\u0424\u0443\u0442\u0431\u043e\u043b\u043a\u0438","\u0427\u0435\u043b\u043e\u0432\u0435\u0447\u043a\u0438","\u0428\u043e\u0440\u0442\u044b","\u0428\u0442\u0430\u043d\u044b"],boys:["\u0410\u043a\u0441\u0435\u0441\u0441\u0443\u0430\u0440\u044b","\u0411\u043e\u0434\u0438 (\u0434\u043b\u0438\u043d\u043d\u044b\u0439 \u0440\u0443\u043a\u0430\u0432)","\u0411\u043e\u0434\u0438 (\u043a\u043e\u0440\u043e\u0442\u043a\u0438\u0439 \u0440\u0443\u043a\u0430\u0432)","\u041a\u043e\u0444\u0442\u044b","\u041d\u0430\u0431\u043e\u0440\u044b","\u041d\u043e\u0441\u043e\u0447\u043a\u0438","\u041f\u0435\u0441\u043e\u0447\u043d\u0438\u043a","\u041f\u0438\u0436\u0430\u043c\u044b","\u041f\u043e\u043b\u0437\u0443\u043d\u043a\u0438","\u0420\u0435\u0433\u043b\u0430\u043d\u044b","\u0424\u0443\u0442\u0431\u043e\u043b\u043a\u0438","\u0427\u0435\u043b\u043e\u0432\u0435\u0447\u043a\u0438","\u0428\u043e\u0440\u0442\u044b","\u0428\u0442\u0430\u043d\u044b"]},g={"\u0414\u0420":"\u0411\u043e\u0434\u0438 (\u0434\u043b\u0438\u043d\u043d\u044b\u0439 \u0440\u0443\u043a\u0430\u0432)","\u041a\u0420":"\u0411\u043e\u0434\u0438 (\u043a\u043e\u0440\u043e\u0442\u043a\u0438\u0439 \u0440\u0443\u043a\u0430\u0432)","\u041a\u043e\u0444\u0442":"\u041a\u043e\u0444\u0442\u044b","\u041d\u0430\u0431\u043e\u0440":"\u041d\u0430\u0431\u043e\u0440\u044b","\u041d\u043e\u0441\u043e\u0447\u043a\u0438":"\u041d\u043e\u0441\u043e\u0447\u043a\u0438","\u041f\u043e\u043b\u0437\u0443\u043d\u043a":"\u041f\u043e\u043b\u0437\u0443\u043d\u043a\u0438","\u041a\u043e\u043b\u0433\u043e\u0442":"\u041a\u043e\u043b\u0433\u043e\u0442\u043a\u0438","\u041f\u0435\u0441\u043e\u0447\u043d\u0438\u043a":"\u041f\u0435\u0441\u043e\u0447\u043d\u0438\u043a","\u041f\u0438\u0436\u0430\u043c":"\u041f\u0438\u0436\u0430\u043c\u044b","\u041f\u043b\u0430\u0442\u044c":"\u041f\u043b\u0430\u0442\u044c\u044f","\u0420\u0435\u0433\u043b\u0430\u043d":"\u0420\u0435\u0433\u043b\u0430\u043d\u044b","\u0424\u0443\u0442\u0431\u043e\u043b\u043a":"\u0424\u0443\u0442\u0431\u043e\u043b\u043a\u0438","\u0427\u0435\u043b\u043e\u0432\u0435\u0447":"\u0427\u0435\u043b\u043e\u0432\u0435\u0447\u043a\u0438","\u0428\u043e\u0440\u0442\u044b":"\u0428\u043e\u0440\u0442\u044b","\u0428\u0442\u0430\u043d\u044b":"\u0428\u0442\u0430\u043d\u044b","\u041b\u043e\u0441\u0438\u043d\u044b":"\u0428\u0442\u0430\u043d\u044b","\u041a\u043e\u0441\u0442\u044e\u043c":"\u041d\u0430\u0431\u043e\u0440\u044b"},v={"\u0411\u043e\u0434\u0438 (\u0434\u043b\u0438\u043d\u043d\u044b\u0439 \u0440\u0443\u043a\u0430\u0432)":"\u0414\u0420","\u0411\u043e\u0434\u0438 (\u043a\u043e\u0440\u043e\u0442\u043a\u0438\u0439 \u0440\u0443\u043a\u0430\u0432)":"\u041a\u0420","\u041a\u043e\u0444\u0442\u044b":"\u041a\u043e\u0444\u0442","\u041d\u0430\u0431\u043e\u0440\u044b":["\u041d\u0430\u0431\u043e\u0440","\u041a\u043e\u0441\u0442\u044e\u043c"],"\u041d\u043e\u0441\u043e\u0447\u043a\u0438":"\u041d\u043e\u0441\u043e\u0447\u043a\u0438","\u041f\u0435\u0441\u043e\u0447\u043d\u0438\u043a":"\u041f\u0435\u0441\u043e\u0447\u043d\u0438\u043a","\u041f\u0438\u0436\u0430\u043c\u044b":"\u041f\u0438\u0436\u0430\u043c","\u041f\u043b\u0430\u0442\u044c\u044f":"\u041f\u043b\u0430\u0442\u044c","\u0420\u0435\u0433\u043b\u0430\u043d\u044b":"\u0420\u0435\u0433\u043b\u0430\u043d","\u0424\u0443\u0442\u0431\u043e\u043b\u043a\u0438":"\u0424\u0443\u0442\u0431\u043e\u043b\u043a","\u0427\u0435\u043b\u043e\u0432\u0435\u0447\u043a\u0438":"\u0427\u0435\u043b\u043e\u0432\u0435\u0447","\u0428\u043e\u0440\u0442\u044b":"\u0428\u043e\u0440\u0442\u044b","\u0428\u0442\u0430\u043d\u044b":["\u0428\u0442\u0430\u043d\u044b","\u041b\u043e\u0441\u0438\u043d\u044b"],"\u041f\u043e\u043b\u0437\u0443\u043d\u043a\u0438":"\u041f\u043e\u043b\u0437\u0443\u043d\u043a","\u041a\u043e\u043b\u0433\u043e\u0442\u043a\u0438":"\u041a\u043e\u043b\u0433\u043e\u0442"},k=["NB","0-3","1-2","2-4","3-6","4-6","6-9","9-12","12-18","18-24","24-36"],I=["all","bi baby","bimini","biorganic","Caramell","Disney baby","DreamKid","Dunnes","H&M","Little Angel","George","little life","Marks & Spencer","Matalan","Next","Tesco","KEHA","\u041c\u0430\u043c\u0438\u043d\u0435 \u0447\u0443\u0434\u043e"],C=n(44),w=n(25);function z(t){return t.match(/([0-9]+)-([0-9]+)|NB/g)[0]}function E(t,e){return"girls"===t||"common"===t?e.girls:e.boys}function F(t,e,n,r){switch(t){case"sales":return-1!==k.indexOf(e)?r&&"".concat(n.showSellSum?n.additionalData.sellSum[e]:r," (").concat((100*n.additionalData.sellSum[e]/n.totalSellSum).toFixed(2),"%)"):r;default:return r}}var Q=function(t,e){var n=t.name.toLowerCase(),r=e.name.toLowerCase();return n<r?-1:n>r?1:0};var R={brandsReport:function(t){return function(e,n){return parseFloat(e[t])-parseFloat(n[t])}},sales:function(t){return function(e,n){return parseInt(e[t])-parseInt(n[t])}}};function B(t,e){var n=t.map((function(t,n){var a=R[e]&&-1===k.indexOf(t)?{sorter:R[e](t)}:{};return Object(w.a)(Object(w.a)({title:t,dataIndex:t,key:n},a),{},{render:function(n,a){return{props:{style:{background:function(t,e){return"total"===t?"white":parseInt(e)>0?"#C7E78F":"#e6948e"}(t,n)}},children:Object(r.jsxs)("div",{children:[F(e,t,a,n)," "]})}}})}));return n.unshift({title:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",dataIndex:"name",key:"name",sorter:Q,width:200}),n}var D=[].concat(Object(C.a)(k),["total"]),N=B([].concat(Object(C.a)(k),["total","totalSellSum"]),"sales"),T=B(D,"stock"),A=B(["sum","profit","profitability"],"brandsReport"),M=(B(["salesCount","profit","salesAvgCheck","sellSum"],"counterpartiesReport"),n(130)),_=n.n(M),L=n(32),K=n.n(L),H={girls:"https://online.moysklad.ru/api/remap/1.2/entity/productfolder/c9ac503e-1d16-11eb-0a80-050d002dcd9a",boys:"https://online.moysklad.ru/api/remap/1.2/entity/productfolder/00cfa023-1d16-11eb-0a80-050d002dade8",unisex:"https://online.moysklad.ru/api/remap/1.2/entity/productfolder/73475072-28e9-11eb-0a80-029000103030"};_.a.defaults.headers.post["Content-Type"]="application/json";var Y=_.a.create({baseURL:"https://kapri-server.herokuapp.com"}),P=function(){var t=Object(O.a)(p.a.mark((function t(e){var n,r,a,i,c,o;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.folderName,r=e.inTransit,a=r?"all":"positiveOnly",i="common"===n?"":"&filter=productFolder=".concat(H[n]),c="https://online.moysklad.ru/api/remap/1.2/report/stock/all?groupBy=consignment&filter=stockMode=".concat(a,"&filter=inTransitOnly=").concat(r)+i,t.next=6,Y.post("/",{link:c});case 6:return o=t.sent,t.abrupt("return",o.data);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),G=function(){var t=Object(O.a)(p.a.mark((function t(e){var n,r,a,i,c,o=arguments;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:"2021-02-15 10:00:00",r=o.length>2&&void 0!==o[2]?o[2]:K()(new Date).format(y),a=e?"&filter=counterparty=".concat(e):"",i="https://online.moysklad.ru/api/remap/1.2/report/profit/byvariant?momentFrom=".concat(n,"&momentTo=").concat(r)+a,t.next=6,Y.post("/",{link:i});case 6:return c=t.sent,t.abrupt("return",c.data);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),J=function(){var t=Object(O.a)(p.a.mark((function t(){var e;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"https://online.moysklad.ru/api/remap/1.2/report/profit/bycounterparty",t.next=3,Y.post("/",{link:"https://online.moysklad.ru/api/remap/1.2/report/profit/bycounterparty"});case 3:return e=t.sent,t.abrupt("return",e.data);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),U=n(92),q=n(108),V=n(57),W=n(67);var X=function(t,e){return t.filter((function(t){return-1!==t.name.indexOf(e)}))};function Z(t,e,n){var r=function(t){return E(t,S).map((function(t){return{name:t,sizes:k.reduce((function(t,e){return Object(w.a)(Object(w.a)({},t),{},Object(W.a)({},e,{width:0,depth:0,inTransit:0}))}),{})}}))}(e);return t.forEach((function(t){var e=z(t.name);r.forEach((function(r){t.folder.name===r.name&&r.sizes[e]&&(r.sizes[e].width+=1,r.sizes[e].depth+=n?t.inTransit:t.stock)}))})),r}function $(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=E(t,S),r=k.reduce((function(t,n){return Object(w.a)(Object(w.a)({},t),{},Object(W.a)({},n,e))}),{});return n.map((function(t,n){return Object(w.a)(Object(w.a)({key:n,name:t,NB:e},r),{},{total:e})}))}var tt=function(t){var e=t.fetchFunc,n=Object(a.useState)(null),i=Object(h.a)(n,2),c=i[0],o=i[1],s=Object(a.useState)(!1),l=Object(h.a)(s,2),u=l[0],d=l[1],f=Object(a.useState)(!1),j=Object(h.a)(f,2),y=j[0],S=j[1],g=Object(a.useState)("all"),v=Object(h.a)(g,2),k=v[0],C=v[1],w=Object(b.e)().sex,z=Object(r.jsx)(m.a,{theme:"dark",selectedKeys:[k],children:I.map((function(t){return Object(r.jsx)(m.a.Item,{onClick:function(){C(t)},children:t},t)}))}),E=function(){var t=Object(O.a)(p.a.mark((function t(){var e,n,r,a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=$(w),d(!0),n={folderName:w,inTransit:y},t.next=5,P(n);case 5:r=t.sent,"all"!==k&&(r=X(r,k)),a=Z(r,w,y),e.forEach((function(t){var e=a.find((function(e){return t.name===e.name})),n=0,r=0;for(var i in e.sizes)n+=e.sizes[i].width,r+=e.sizes[i].depth,t[i]="".concat(e.sizes[i].depth," (").concat(e.sizes[i].width,") ");t.total="".concat(r," (").concat(n,")")})),o(e),d(!1);case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(a.useEffect)((function(){E(e)}),[w,y,k]),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(q.a,{overlay:z,placement:"bottomCenter",children:Object(r.jsx)(V.a,{children:"\u0411\u0440\u0435\u043d\u0434"})}),Object(r.jsx)(U.a,{style:{marginLeft:"30px"},onChange:function(){return S((function(t){return!t}))},children:"In transit"}),Object(r.jsx)(x.a,{dataSource:c,columns:T,columnstock:"3px",pagination:!1,bordered:!0,loading:u})]})},et=n(350),nt={boys:"\u041c",girls:"\u0414",unisex:"\u0423"};function rt(t,e){return"common"===e?t:t.filter((function(t){return function(t,e){var n="^[".concat(nt[e],"]{1}"),r=t.match(n);if(r)return nt[e]===r[0]}(t.assortment.name,e)}))}function at(t,e){var n=[],r=function(t){return function(e){return-1!==e.assortment.name.indexOf(t)}};return e instanceof Array&&e.length>0?e.forEach((function(e){n.push.apply(n,Object(C.a)(t.filter(r(e))))})):n.push.apply(n,Object(C.a)(t.filter(r(e)))),n}function it(t,e,n){var r=Object(C.a)(t);return e.forEach((function(t){at(n,[t]).forEach((function(e){var n=function(t,e){return t.find((function(t){return t.name===g[e]}))}(r,t),a=z(e.assortment.name);n[a]+=e.sellQuantity,n.total+=e.sellQuantity,n.sellSum=+e.sellSum,n.totalSellSum+=Number((e.sellSum/100).toFixed(0)),function(t,e,n){var r=t.additionalData.sellSum[n],a=(e.sellSum/100).toFixed(0);r?t.additionalData.sellSum[n]+=Number(a):t.additionalData.sellSum[n]=Number(a)}(n,e,a)}))})),r}var ct=n(128),ot=n.n(ct),st=Object.keys(g),lt=et.a.RangePicker,ut=function(t){var e=t.counterparties,n=Object(b.e)().sex,i=Object(a.useState)(null),c=Object(h.a)(i,2),o=c[0],s=c[1],l=Object(a.useState)(!1),u=Object(h.a)(l,2),d=u[0],f=u[1],j=Object(a.useState)(null),p=Object(h.a)(j,2),O=p[0],g=p[1],v=Object(a.useState)(""),I=Object(h.a)(v,2),C=I[0],z=I[1],F=Object(a.useState)(""),Q=Object(h.a)(F,2),R=Q[0],B=Q[1],D=Object(a.useState)(!0),T=Object(h.a)(D,2),A=T[0],M=T[1],_=e&&Object(r.jsxs)(m.a,{theme:"dark",selectedKeys:[O?O.name:"All"],children:[Object(r.jsx)(m.a.Item,{onClick:function(){g(null)},children:"All"},"All"),e.map((function(t){return Object(r.jsx)(m.a.Item,{onClick:function(){g(t.counterparty)},children:t.counterparty.name},t.counterparty.name)}))]}),L=function(t){f(!0);var e=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=E(t,S),a=k.reduce((function(t,n){return Object(w.a)(Object(w.a)({},t),{},Object(W.a)({},n,e))}),{});return r.map((function(t,r){return Object(w.a)(Object(w.a)({key:r,name:t,NB:e},a),{},{total:e,totalSellSum:e,additionalData:{sellSum:{}},showSellSum:n})}))}(n,0,A),r=rt(t,n);e=it(e,st,r),s(e),f(!1)};return Object(a.useEffect)((function(){var t=O?O.meta.href:O;G(t,C,R).then((function(t){return L(t)}))}),[n,O,A,C,R]),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(lt,{onChange:function(t){z(K()(t[0]._d).format(y)),B(K()(t[1]._d).format(y))},format:y,size:"large"}),Object(r.jsx)(q.a,{overlay:_,placement:"bottomCenter",children:Object(r.jsx)(V.a,{children:O?O.name:"\u041a\u043e\u043d\u0442\u0440\u0430\u0433\u0435\u043d\u0442"})}),Object(r.jsx)(ot.a,{checked:A,style:{marginLeft:"30px"},onChange:function(){return M((function(t){return!t}))},children:"SellSum"}),Object(r.jsx)(x.a,{dataSource:o,columns:N,columnstock:"3px",pagination:!1,bordered:!0,loading:d})]})};function dt(t){return Object(C.a)(t).map((function(t,e){return{key:e,name:t,sum:0,profit:0,sellCostSum:0,profitability:0}}))}var ft=function(t){return t.map((function(t){var e=+(100*t.profit/t.sellCostSum).toFixed(2);return Object(w.a)(Object(w.a)({},t),{},{sum:(t.sum/100).toFixed(2),profit:(t.profit/100).toFixed(2),profitability:e?e+"%":0})}))},bt=function(t,e,n){var r=Object(C.a)(t);return n>-1&&(r[n]=Object(w.a)(Object(w.a)({},r[n]),{},{sum:r[n].sum+=+e.sellSum,profit:r[n].profit+=+e.profit,sellCostSum:r[n].sellCostSum+=+e.sellCostSum})),r},mt=function(t,e){return t.filter((function(t){return-1!==t.assortment.name.indexOf(e)}))},jt=et.a.RangePicker,pt={brands:I.slice(1),sizes:k},Ot=function(){var t=Object(b.e)().sex,e=Object(b.e)().reportBy,n=Object(a.useState)(dt(pt[e])),i=Object(h.a)(n,2),c=i[0],o=i[1],s=Object(a.useState)(!1),l=Object(h.a)(s,2),u=l[0],d=l[1],f=Object(a.useState)(""),m=Object(h.a)(f,2),j=m[0],S=m[1],g=Object(a.useState)(""),v=Object(h.a)(g,2),k=v[0],C=v[1],w=function(){var n=Object(O.a)(p.a.mark((function n(r,a){var i,c;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return d(!0),n.next=3,G(void 0,r,a);case 3:i=rt(i=n.sent,t),c=dt(pt[e]),"brands"===e?I.forEach((function(t){mt(i,t).forEach((function(e){var n=c.findIndex((function(e){return e.name===t}));c=bt(c,e,n)}))})):"sizes"===e&&i.forEach((function(t){var e=c.findIndex((function(e){return e.name===z(t.assortment.name)}));c=bt(c,t,e)})),o(ft(c)),d(!1);case 9:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}();return Object(a.useEffect)((function(){w(j,k)}),[t,j,k,e]),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(jt,{onChange:function(t){S(K()(t[0]._d).format(y)),C(K()(t[1]._d).format(y))},format:y,size:"large"}),Object(r.jsx)(x.a,{style:{width:"70vw"},dataSource:c,columns:A,columnstock:"3px",pagination:!1,bordered:!0,loading:u})]})},ht={"\u041c":"boys","\u0414":"girls","\u0423":"unisex"},xt=function(){return S.girls.map((function(t,e){return{idx:e,name:t,categories:{girls:{sellQuantity:0,sellSum:0,profit:0,profitability:0,sellCostSum:0},boys:{sellQuantity:0,sellSum:0,profit:0,profitability:0,sellCostSum:0},unisex:{sellQuantity:0,sellSum:0,profit:0,profitability:0,sellCostSum:0},total:{sellQuantity:0,sellSum:0,profit:0,profitability:0,sellCostSum:0}}}}))},yt=[{title:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f \u0442\u043e\u0432\u0430\u0440\u043e\u0432",dataIndex:"name",key:"name",width:100,fixed:"left"},{title:"Girls",children:[{title:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e",dataIndex:["categories","girls","sellQuantity"],key:"sellQuantity"},{title:"\u0421\u0443\u043c\u043c\u0430, \u0433\u0440\u043d",dataIndex:["categories","girls","sellSum"],key:"sellSum"},{title:"\u041f\u0440\u0438\u0431\u044b\u043b\u044c, \u0433\u0440\u043d",dataIndex:["categories","girls","profit"],key:"profit"},{title:"\u0420\u0435\u043d\u0442\u0430\u0431\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c, %",dataIndex:["categories","girls","profitability"],key:"profitability"}]},{title:"Boys",children:[{title:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e",dataIndex:["categories","boys","sellQuantity"],key:"sellQuantity"},{title:"\u0421\u0443\u043c\u043c\u0430, \u0433\u0440\u043d",dataIndex:["categories","boys","sellSum"],key:"sellSum"},{title:"\u041f\u0440\u0438\u0431\u044b\u043b\u044c, \u0433\u0440\u043d",dataIndex:["categories","boys","profit"],key:"profit"},{title:"\u0420\u0435\u043d\u0442\u0430\u0431\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c, %",dataIndex:["categories","boys","profitability"],key:"profitability"}]},{title:"Unisex",children:[{title:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e",dataIndex:["categories","unisex","sellQuantity"],key:"sellQuantity"},{title:"\u0421\u0443\u043c\u043c\u0430, \u0433\u0440\u043d",dataIndex:["categories","unisex","sellSum"],key:"sellSum"},{title:"\u041f\u0440\u0438\u0431\u044b\u043b\u044c, \u0433\u0440\u043d",dataIndex:["categories","unisex","profit"],key:"profit"},{title:"\u0420\u0435\u043d\u0442\u0430\u0431\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c, %",dataIndex:["categories","unisex","profitability"],key:"profitability"}]},{title:"Total",children:[{title:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e",dataIndex:["categories","total","sellQuantity"],key:"sellQuantity"},{title:"\u0421\u0443\u043c\u043c\u0430, \u0433\u0440\u043d",dataIndex:["categories","total","sellSum"],key:"sellSum"},{title:"\u041f\u0440\u0438\u0431\u044b\u043b\u044c, \u0433\u0440\u043d",dataIndex:["categories","total","profit"],key:"profit"},{title:"\u0420\u0435\u043d\u0442\u0430\u0431\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c, %",dataIndex:["categories","total","profitability"],key:"profitability"}]}],St=et.a.RangePicker,gt=function(){var t=Object(a.useState)(xt()),e=Object(h.a)(t,2),n=e[0],i=e[1],c=Object(a.useState)(!1),o=Object(h.a)(c,2),s=o[0],l=o[1],u=Object(a.useState)(""),d=Object(h.a)(u,2),f=d[0],b=d[1],m=Object(a.useState)(""),j=Object(h.a)(m,2),p=j[0],O=j[1];function S(t){var e=xt();e.forEach((function(e){var n=e.categories,r=n.total;at(t,v[e.name]).forEach((function(t){var e,a=(e=t.assortment.name,ht[e[0]]);n[a].sellQuantity+=+t.sellQuantity,n[a].sellSum+=+t.sellSum,n[a].profit+=+t.profit,n[a].sellCostSum+=+t.sellCostSum,r.sellQuantity+=+t.sellQuantity,r.sellSum+=+t.sellSum,r.profit+=+t.profit,r.sellCostSum+=+t.sellCostSum}))})),e.forEach((function(t){var e=t.categories;for(var n in t.categories){var r=!!t.categories[n].sellCostSum&&+(100*t.categories[n].profit/t.categories[n].sellCostSum).toFixed(2);e[n].sellSum=+(parseInt(e[n].sellSum)/100).toFixed(0),e[n].profit=+(parseInt(e[n].profit)/100).toFixed(0),e[n].profitability=r?r+"%":0}})),i(e),l(!1)}return Object(a.useEffect)((function(){l(!0),G(void 0,f,p).then((function(t){S(t)}))}),[p,f]),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(St,{style:{marginTop:"2rem"},onChange:function(t){b(K()(t[0]._d).format(y)),O(K()(t[1]._d).format(y))},format:y,size:"large"}),Object(r.jsx)(x.a,{style:{width:"70vw"},dataSource:n,columns:yt,size:"small",columnstock:"3px",pagination:!1,bordered:!0,loading:s})]})},vt=["salesCount","profit","salesAvgCheck","sellSum"];function kt(t,e){return t.map((function(t,n){var r=e.reduce((function(t,e){return t[e]=0,t}),{});return Object(w.a)({key:n,name:t},r)}))}var It=function(t){var e=[].concat(Object(C.a)(t.counterparties.map((function(t){return t.counterparty.name}))),["total"]),n=B(e,"counterpartiesReport"),i=Object(a.useState)(kt(vt,e)),c=Object(h.a)(i,2),o=c[0],s=c[1];return Object(a.useEffect)((function(){!function(t,e){var n=kt(vt,e);t.forEach((function(t){var e=function(e){n.some((function(t){return t.name===e}))&&(n.find((function(t){return t.name===e}))[t.counterparty.name]="salesCount"!==e?+(parseInt(t[e])/100).toFixed(0):t[e])};for(var r in t)e(r)})),n.forEach((function(t){t.total=e.reduce((function(e,n){return e+t[n]}),0)})),s(n)}(t.counterparties,e)}),[t.counterparties]),Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(x.a,{style:{width:"70vw"},dataSource:o,columns:n,size:"small",columnstock:"3px",pagination:!1,bordered:!0,loading:t.loading})})},Ct=m.a.SubMenu,wt=function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(){var t;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))).state={current:null,counterparties:null,loading:!1},t.handleClick=function(e){t.setState({current:e.key})},t}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var t=this;this.setState({loading:!0}),J().then((function(e){t.setState({counterparties:e,loading:!1})}))}},{key:"render",value:function(){var t=this,e=this.state.current;return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(m.a,{onClick:this.handleClick,selectedKeys:[e],mode:"horizontal",theme:"dark",children:[Object(r.jsxs)(Ct,{title:"\u041c\u0430\u043b\u044c\u0447\u0438\u043a\u0438",children:[Object(r.jsx)(m.a.Item,{children:Object(r.jsx)(f.b,{to:"/stock/boys",children:"O\u0441\u0442\u0430\u0442\u043a\u0438 "})},"boysStock"),Object(r.jsx)(m.a.Item,{children:Object(r.jsx)(f.b,{to:"/sales/boys",children:"\u041f\u0440\u043e\u0434\u0430\u0436\u0438 "})},"boysSales"),Object(r.jsx)(m.a.Item,{children:Object(r.jsx)(f.b,{to:"/report/boys/brands",children:"\u041e\u0442\u0447\u0435\u0442 \u043f\u043e \u0431\u0440\u0435\u043d\u0434\u0430\u043c "})},"boysBrandReport"),Object(r.jsx)(m.a.Item,{children:Object(r.jsx)(f.b,{to:"/report/boys/sizes",children:"\u041e\u0442\u0447\u0435\u0442 \u043f\u043e \u0440\u0430\u0437\u043c\u0435\u0440\u0430\u043c "})},"boysSizesReport")]},"boys"),Object(r.jsxs)(Ct,{title:"\u0414\u0435\u0432\u043e\u0447\u043a\u0438",children:[Object(r.jsx)(m.a.Item,{children:Object(r.jsx)(f.b,{to:"/stock/girls",children:"O\u0441\u0442\u0430\u0442\u043a\u0438 "})},"girlsStock"),Object(r.jsx)(m.a.Item,{children:Object(r.jsx)(f.b,{to:"/sales/girls",children:"\u041f\u0440\u043e\u0434\u0430\u0436\u0438 "})},"girlsSales"),Object(r.jsx)(m.a.Item,{children:Object(r.jsx)(f.b,{to:"/report/girls/brands",children:"\u041e\u0442\u0447\u0435\u0442 \u043f\u043e \u0431\u0440\u0435\u043d\u0434\u0430\u043c "})},"girlsBrandReport"),Object(r.jsx)(m.a.Item,{children:Object(r.jsx)(f.b,{to:"/report/girls/sizes",children:"\u041e\u0442\u0447\u0435\u0442 \u043f\u043e \u0440\u0430\u0437\u043c\u0435\u0440\u0430\u043c "})},"girlsSizesReport")]},"girls"),Object(r.jsxs)(Ct,{title:"\u0423\u043d\u0438\u0441\u0435\u043a\u0441",children:[Object(r.jsx)(m.a.Item,{children:Object(r.jsx)(f.b,{to:"/stock/unisex",children:"O\u0441\u0442\u0430\u0442\u043a\u0438"})},"unisexStock"),Object(r.jsx)(m.a.Item,{children:Object(r.jsx)(f.b,{to:"/sales/unisex",children:"\u041f\u0440\u043e\u0434\u0430\u0436\u0438"})},"unisexSales"),Object(r.jsx)(m.a.Item,{children:Object(r.jsx)(f.b,{to:"/report/unisex/brands",children:"\u041e\u0442\u0447\u0435\u0442 \u043f\u043e \u0431\u0440\u0435\u043d\u0434\u0430\u043c "})},"unisexBrandReport"),Object(r.jsx)(m.a.Item,{children:Object(r.jsx)(f.b,{to:"/report/unisex/sizes",children:"\u041e\u0442\u0447\u0435\u0442 \u043f\u043e \u0440\u0430\u0437\u043c\u0435\u0440\u0430\u043c "})},"unisexSizesReport")]},"unisex"),Object(r.jsxs)(Ct,{title:"\u041e\u0431\u0449\u0435\u0435",children:[Object(r.jsx)(m.a.Item,{children:Object(r.jsx)(f.b,{to:"/stock/common",children:"O\u0441\u0442\u0430\u0442\u043a\u0438"})},"commonStock"),Object(r.jsx)(m.a.Item,{children:Object(r.jsx)(f.b,{to:"/sales/common",children:"\u041f\u0440\u043e\u0434\u0430\u0436\u0438"})},"commonSales"),Object(r.jsx)(m.a.Item,{children:Object(r.jsx)(f.b,{to:"/report/common/brands",children:"\u041e\u0442\u0447\u0435\u0442 \u043f\u043e \u0431\u0440\u0435\u043d\u0434\u0430\u043c "})},"commonBrandReport"),Object(r.jsx)(m.a.Item,{children:Object(r.jsx)(f.b,{to:"/report/common/sizes",children:"\u041e\u0442\u0447\u0435\u0442 \u043f\u043e \u0440\u0430\u0437\u043c\u0435\u0440\u0430\u043c "})},"commonSizesReport")]},"common")]}),Object(r.jsx)(b.a,{exact:!0,path:"/stock/:sex",render:function(){return Object(r.jsx)(tt,{})}}),Object(r.jsx)(b.a,{path:"/sales/:sex",render:function(){return Object(r.jsx)(ut,{counterparties:t.state.counterparties})}}),Object(r.jsx)(b.a,{path:"/report/:sex/:reportBy",render:function(){return Object(r.jsx)(Ot,{})}}),Object(r.jsx)(gt,{}),this.state.counterparties&&Object(r.jsx)(It,{counterparties:this.state.counterparties})]})}}]),n}(i.a.Component);o.a.render(Object(r.jsx)(f.a,{children:Object(r.jsx)(wt,{})}),document.getElementById("root"))}},[[347,1,2]]]);
//# sourceMappingURL=main.134f05fb.chunk.js.map