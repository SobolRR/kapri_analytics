(this.webpackJsonpkapri_analytics=this.webpackJsonpkapri_analytics||[]).push([[0],{157:function(t,e,n){},250:function(t,e,n){"use strict";n.r(e);var r=n(7),a=n(0),c=n.n(a),i=n(28),s=n.n(i),o=(n(157),n(134)),u=n(135),l=n(150),d=n(147),m=n(30),b=n.n(m),j=n(55),p=n(50),f=n(22),h=n(252),O="YYYY-MM-DD HH:mm:ss",x={girls:["\u0410\u043a\u0441\u0435\u0441\u0441\u0443\u0430\u0440\u044b","\u0411\u043e\u0434\u0438 (\u0434\u043b\u0438\u043d\u043d\u044b\u0439 \u0440\u0443\u043a\u0430\u0432)","\u0411\u043e\u0434\u0438 (\u043a\u043e\u0440\u043e\u0442\u043a\u0438\u0439 \u0440\u0443\u043a\u0430\u0432)","\u041a\u043e\u0444\u0442\u044b","\u041d\u0430\u0431\u043e\u0440\u044b","\u041f\u0435\u0441\u043e\u0447\u043d\u0438\u043a","\u041f\u0438\u0436\u0430\u043c\u044b","\u041f\u043b\u0430\u0442\u044c\u044f","\u0420\u0435\u0433\u043b\u0430\u043d\u044b","\u0424\u0443\u0442\u0431\u043e\u043b\u043a\u0438","\u0427\u0435\u043b\u043e\u0432\u0435\u0447\u043a\u0438","\u0428\u043e\u0440\u0442\u044b","\u0428\u0442\u0430\u043d\u044b"],boys:["\u0410\u043a\u0441\u0435\u0441\u0441\u0443\u0430\u0440\u044b","\u0411\u043e\u0434\u0438 (\u0434\u043b\u0438\u043d\u043d\u044b\u0439 \u0440\u0443\u043a\u0430\u0432)","\u0411\u043e\u0434\u0438 (\u043a\u043e\u0440\u043e\u0442\u043a\u0438\u0439 \u0440\u0443\u043a\u0430\u0432)","\u041a\u043e\u0444\u0442\u044b","\u041d\u0430\u0431\u043e\u0440\u044b","\u041f\u0435\u0441\u043e\u0447\u043d\u0438\u043a","\u041f\u0438\u0436\u0430\u043c\u044b","\u0420\u0435\u0433\u043b\u0430\u043d\u044b","\u0424\u0443\u0442\u0431\u043e\u043b\u043a\u0438","\u0427\u0435\u043b\u043e\u0432\u0435\u0447\u043a\u0438","\u0428\u043e\u0440\u0442\u044b","\u0428\u0442\u0430\u043d\u044b"]},y={"\u0414\u0420":"\u0411\u043e\u0434\u0438 (\u0434\u043b\u0438\u043d\u043d\u044b\u0439 \u0440\u0443\u043a\u0430\u0432)","\u041a\u0420":"\u0411\u043e\u0434\u0438 (\u043a\u043e\u0440\u043e\u0442\u043a\u0438\u0439 \u0440\u0443\u043a\u0430\u0432)","\u041a\u043e\u0444\u0442":"\u041a\u043e\u0444\u0442\u044b","\u041d\u0430\u0431\u043e\u0440":"\u041d\u0430\u0431\u043e\u0440\u044b","\u041f\u0435\u0441\u043e\u0447\u043d\u0438\u043a":"\u041f\u0435\u0441\u043e\u0447\u043d\u0438\u043a","\u041f\u0438\u0436\u0430\u043c":"\u041f\u0438\u0436\u0430\u043c\u044b","\u041f\u043b\u0430\u0442\u044c":"\u041f\u043b\u0430\u0442\u044c\u044f","\u0420\u0435\u0433\u043b\u0430\u043d":"\u0420\u0435\u0433\u043b\u0430\u043d\u044b","\u0424\u0443\u0442\u0431\u043e\u043b\u043a":"\u0424\u0443\u0442\u0431\u043e\u043b\u043a\u0438","\u0427\u0435\u043b\u043e\u0432\u0435\u0447":"\u0427\u0435\u043b\u043e\u0432\u0435\u0447\u043a\u0438","\u0428\u043e\u0440\u0442\u044b":"\u0428\u043e\u0440\u0442\u044b","\u0428\u0442\u0430\u043d\u044b":"\u0428\u0442\u0430\u043d\u044b","\u041b\u043e\u0441\u0438\u043d\u044b":"\u0428\u0442\u0430\u043d\u044b","\u041a\u043e\u0441\u0442\u044e\u043c":"\u041d\u0430\u0431\u043e\u0440\u044b"},k=["NB","0-3","1-2","2-4","3-6","4-6","6-9","9-12","12-18","18-24","24-36"],v=n(115);function g(t){return t.match(/([0-9]+)-([0-9]+)|NB/g)[0]}function S(t,e){return"girls"===t||"common"===t?e.girls:e.boys}function w(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=S(t,x);return n.map((function(t,n){return{key:n,name:t,NB:e,"0-3":e,"1-2":e,"2-4":e,"3-6":e,"4-6":e,"6-9":e,"9-12":e,"12-18":e,"18-24":e,"24-36":e,total:e,sellSum:e,additionalData:{sellSum:{}}}}))}function T(t){var e=t.map((function(t,e){return{title:t,dataIndex:t,key:e,render:function(e,n){console.log(n);var a="total"===t?"white":parseInt(e)>0?"#C7E78F":"#e6948e",c=n.sellSum&&-1!==k.indexOf(t)?e&&"".concat(e," (").concat((100*n.additionalData.sellSum[t]/n.sellSum).toFixed(2),"%)"):e;return{props:{style:{background:a}},children:Object(r.jsxs)("div",{children:[c," "]})}}}}));return e.unshift({title:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",dataIndex:"name",key:"name"}),e}var I=[].concat(Object(v.a)(k),["total"]),C=T([].concat(Object(v.a)(k),["total","sellSum"])),z=T(I),D=n(109),E=n.n(D),N=n(31),F=n.n(N),M={girls:"https://online.moysklad.ru/api/remap/1.2/entity/productfolder/c9ac503e-1d16-11eb-0a80-050d002dcd9a",boys:"https://online.moysklad.ru/api/remap/1.2/entity/productfolder/00cfa023-1d16-11eb-0a80-050d002dade8",unisex:"https://online.moysklad.ru/api/remap/1.2/entity/productfolder/73475072-28e9-11eb-0a80-029000103030"};E.a.defaults.headers.post["Content-Type"]="application/json";var B=E.a.create({baseURL:"https://kapri-server.herokuapp.com"}),A=function(){var t=Object(j.a)(b.a.mark((function t(e){var n,r,a,c,i,s;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.folderName,r=e.inTransit,a=r?"all":"positiveOnly",c="common"===n?"":"&filter=productFolder=".concat(M[n]),i="https://online.moysklad.ru/api/remap/1.2/report/stock/all?groupBy=consignment&filter=stockMode=".concat(a,"&filter=inTransitOnly=").concat(r)+c,t.next=6,B.post("/",{link:i});case 6:return s=t.sent,t.abrupt("return",s.data);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),K=function(){var t=Object(j.a)(b.a.mark((function t(e){var n,r,a,c,i,s=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:"2020-11-01 00:00:00",r=s.length>2&&void 0!==s[2]?s[2]:F()(new Date).format(O),a=e?"&filter=counterparty=".concat(e):"",c="https://online.moysklad.ru/api/remap/1.2/report/profit/byvariant?momentFrom=".concat(n,"&momentTo=").concat(r)+a,t.next=6,B.post("/",{link:c});case 6:return i=t.sent,t.abrupt("return",i.data);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),H=function(){var t=Object(j.a)(b.a.mark((function t(){var e;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"https://online.moysklad.ru/api/remap/1.2/report/profit/bycounterparty",t.next=3,B.post("/",{link:"https://online.moysklad.ru/api/remap/1.2/report/profit/bycounterparty"});case 3:return e=t.sent,t.abrupt("return",e.data);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Y=n(77),_=n(59),L=n(96),R=n(48);function J(t){return S(t,x).map((function(t){return{name:t,sizes:{NB:{width:0,depth:0,inTransit:0},"0-3":{width:0,depth:0,inTransit:0},"1-2":{width:0,depth:0,inTransit:0},"2-4":{width:0,depth:0,inTransit:0},"3-6":{width:0,depth:0,inTransit:0},"4-6":{width:0,depth:0,inTransit:0},"6-9":{width:0,depth:0,inTransit:0},"9-12":{width:0,depth:0,inTransit:0},"12-18":{width:0,depth:0,inTransit:0},"18-24":{width:0,depth:0,inTransit:0},"24-36":{width:0,depth:0,inTransit:0}}}}))}var Q=["all","bi baby","bimini","biorganic","Disney baby","DreamKid","Dunnes","H&M","Little Angel","George","little life","Marks & Spencer","Matalan","Next","Tasco","KEHA","\u041c\u0430\u043c\u0438\u043d\u0435 \u0447\u0443\u0434\u043e"],G=function(t){var e=t.fetchFunc,n=Object(a.useState)(null),c=Object(p.a)(n,2),i=c[0],s=c[1],o=Object(a.useState)(!1),u=Object(p.a)(o,2),l=u[0],d=u[1],m=Object(a.useState)(!1),O=Object(p.a)(m,2),x=O[0],y=O[1],k=Object(a.useState)("all"),v=Object(p.a)(k,2),S=v[0],T=v[1],I=Object(f.e)().sex,C=Object(r.jsx)(_.a,{theme:"dark",selectedKeys:[S],children:Q.map((function(t){return Object(r.jsx)(_.a.Item,{onClick:function(){T(t)},children:t},t)}))}),D=function(){var t=Object(j.a)(b.a.mark((function t(){var e,n,r,a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=J(I),n=w(I),d(!0),r={folderName:I,inTransit:x},t.next=6,A(r);case 6:a=t.sent,"all"!==S&&(a=P(a,S)),a.forEach((function(t){var n=g(t.name);e.forEach((function(e){t.folder.name===e.name&&e.sizes[n]&&(e.sizes[n].width+=1,e.sizes[n].depth+=x?t.inTransit:t.stock)}))})),n.forEach((function(t){var n=e.find((function(e){return t.name===e.name})),r=0,a=0;for(var c in n.sizes)r+=n.sizes[c].width,a+=n.sizes[c].depth;for(var i in t.total="".concat(a," (").concat(r,")"),n.sizes)t[i]="".concat(n.sizes[i].depth," (").concat(n.sizes[i].width,") ")})),s(n),d(!1);case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(a.useEffect)((function(){D(e)}),[I,x,S]),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(L.a,{overlay:C,placement:"bottomCenter",children:Object(r.jsx)(R.a,{children:"\u0411\u0440\u0435\u043d\u0434"})}),Object(r.jsx)(Y.a,{style:{marginLeft:"30px"},onChange:function(){return y((function(t){return!t}))},children:"In transit"}),Object(r.jsx)(h.a,{dataSource:i,columns:z,columnstock:"3px",pagination:!1,bordered:!0,loading:l})]})},P=function(t,e){return t.filter((function(t){return-1!==t.name.indexOf(e)}))},U=n(29),q=n(253),V={boys:"\u041c",girls:"\u0414",unisex:"\u0423"},W=Object.keys(y),X=q.a.RangePicker,Z=function(){var t=Object(f.e)().sex,e=Object(a.useState)(null),n=Object(p.a)(e,2),c=n[0],i=n[1],s=Object(a.useState)(!1),o=Object(p.a)(s,2),u=o[0],l=o[1],d=Object(a.useState)(null),m=Object(p.a)(d,2),x=m[0],y=m[1],k=Object(a.useRef)([]),v=Object(r.jsxs)(_.a,{theme:"dark",selectedKeys:[x],children:[Object(r.jsx)(_.a.Item,{onClick:function(){y(null)},children:"All"},"All"),k.current.map((function(t){return Object(r.jsx)(_.a.Item,{onClick:function(){y(t.counterparty.meta.href)},children:t.counterparty.name},t.counterparty.name)}))]}),g=function(){var e=Object(j.a)(b.a.mark((function e(n,r,a){var c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),e.next=3,K(n,r,a);case 3:c=e.sent,c="common"===t?c:$(c,t),i(tt(W,c,t)),l(!1);case 7:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){H().then((function(t){k.current=t}))}),[]),Object(a.useEffect)((function(){g(x)}),[t,x]),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(X,{onChange:function(t){g(x,F()(t[0]._d).format(O),F()(t[1]._d).format(O))},format:O,size:"large"}),Object(r.jsx)(L.a,{overlay:v,placement:"bottomCenter",children:Object(r.jsx)(R.a,{children:"\u041a\u043e\u043d\u0442\u0440\u0430\u0433\u0435\u043d\u0442"})}),Object(r.jsx)(h.a,{dataSource:c,columns:C,columnstock:"3px",pagination:!1,bordered:!0,loading:u})]})};function $(t,e){return t.filter((function(t){return function(t,e){var n="^[".concat(V[e],"]{1}"),r=t.match(n);if(r)return V[e]===r[0]}(t.assortment.name,e)}))}function tt(t,e,n){var r=w(n,0);return t.forEach((function(t){(function(t,e){return t.filter((function(t){return-1!==t.assortment.name.indexOf(e)}))})(e,t).forEach((function(e){var n=function(t,e){return t.find((function(t){return t.name===y[e]}))}(r,t),a=g(e.assortment.name);n[a]+=e.sellQuantity,n.total+=e.sellQuantity,n.sellSum+=Number((e.sellSum/100).toFixed(0)),n.additionalData.sellSum[a]?n.additionalData.sellSum[a]+=Number(e.sellSum/100):n.additionalData.sellSum[a]=Number(e.sellSum/100)}))})),r}var et=_.a.SubMenu,nt=function(t){Object(l.a)(n,t);var e=Object(d.a)(n);function n(){var t;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).state={current:"mail"},t.handleClick=function(e){t.setState({current:e.key})},t}return Object(u.a)(n,[{key:"render",value:function(){var t=this.state.current;return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(_.a,{onClick:this.handleClick,selectedKeys:[t],mode:"horizontal",theme:"dark",children:[Object(r.jsxs)(et,{title:"\u041c\u0430\u043b\u044c\u0447\u0438\u043a\u0438",children:[Object(r.jsx)(_.a.Item,{children:Object(r.jsx)(U.b,{to:"/stock/boys",children:"O\u0441\u0442\u0430\u0442\u043a\u0438 "})},"boysStock"),Object(r.jsx)(_.a.Item,{children:Object(r.jsx)(U.b,{to:"/sales/boys",children:"\u041f\u0440\u043e\u0434\u0430\u0436\u0438 "})},"boysSales")]},"boys"),Object(r.jsxs)(et,{title:"\u0414\u0435\u0432\u043e\u0447\u043a\u0438",children:[Object(r.jsx)(_.a.Item,{children:Object(r.jsx)(U.b,{to:"/stock/girls",children:"O\u0441\u0442\u0430\u0442\u043a\u0438 "})},"girlsStock"),Object(r.jsx)(_.a.Item,{children:Object(r.jsx)(U.b,{to:"/sales/girls",children:"\u041f\u0440\u043e\u0434\u0430\u0436\u0438 "})},"girlsSales")]},"girls"),Object(r.jsxs)(et,{title:"\u0423\u043d\u0438\u0441\u0435\u043a\u0441",children:[Object(r.jsx)(_.a.Item,{children:Object(r.jsx)(U.b,{to:"/stock/unisex",children:"O\u0441\u0442\u0430\u0442\u043a\u0438"})},"unisexStock"),Object(r.jsx)(_.a.Item,{children:Object(r.jsx)(U.b,{to:"/sales/unisex",children:"\u041f\u0440\u043e\u0434\u0430\u0436\u0438"})},"unisexSales")]},"unisex"),Object(r.jsxs)(et,{title:"\u041e\u0431\u0449\u0435\u0435",children:[Object(r.jsx)(_.a.Item,{children:Object(r.jsx)(U.b,{to:"/stock/common",children:"O\u0441\u0442\u0430\u0442\u043a\u0438"})},"commonStock"),Object(r.jsx)(_.a.Item,{children:Object(r.jsx)(U.b,{to:"/sales/common",children:"\u041f\u0440\u043e\u0434\u0430\u0436\u0438"})},"commonSales")]},"common")]}),Object(r.jsx)(f.a,{exact:!0,path:"/stock/:sex",render:function(){return Object(r.jsx)(G,{})}}),Object(r.jsx)(f.a,{path:"/sales/:sex",render:function(){return Object(r.jsx)(Z,{})}})]})}}]),n}(c.a.Component);s.a.render(Object(r.jsx)(U.a,{children:Object(r.jsx)(nt,{})}),document.getElementById("root"))}},[[250,1,2]]]);
//# sourceMappingURL=main.0e47509f.chunk.js.map