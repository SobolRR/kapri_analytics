{"version":3,"sources":["data.js","utils/utils.js","core/api.js","components/SalesTable/StockTable.js","components/SalesTable/SalesTable.js","App.js","index.js"],"names":["dateFormat","productGroups","girls","boys","productNamesToFolders","sizes","getSize","name","match","defineProductsBySex","sex","createDefaultDataSource","initial","products","map","product","idx","key","NB","sellSum","createColumns","titles","res","title","dataIndex","render","value","record","console","log","background","parseInt","indexOf","additionalData","toFixed","props","style","children","unshift","stockTitles","sellColumns","stockColumns","folderLinks","unisex","axios","defaults","headers","post","instance","create","baseURL","fetchStock","options","a","folderName","inTransit","stockMode","folderFilter","link","result","data","fetchSales","counterparty","momentFrom","momentTo","moment","Date","format","counterpartyFilter","fetchCounterparty","createDefaultStock","width","depth","brands","StockTable","fetchFunc","useState","dataSource","setDataSource","isLoading","setIsLoading","setInTransit","brand","setBrand","useParams","menu","theme","selectedKeys","Item","onClick","updateDataSource","stockData","newDataSource","filterByBrand","forEach","good","size","item","folder","stock","find","el","totalW","totalD","total","useEffect","overlay","placement","onChange","prev","columns","columnstock","pagination","bordered","loading","filter","mapSexToSymbol","productNames","Object","keys","RangePicker","DatePicker","SalesTable","setCounterparty","counterparties","useRef","counterpartyMenu","current","meta","href","filterBySex","updateSalesData","then","moments","_d","str","re","checkSex","assortment","filterByProductName","productFolder","findFolderByProductName","sellQuantity","Number","SubMenu","Menu","App","state","handleClick","e","setState","this","mode","to","exact","path","React","Component","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.0e47509f.chunk.js","sourcesContent":["export const dateFormat = 'YYYY-MM-DD HH:mm:ss';\n\nexport const productGroups = {\n  girls:[\n    \"Аксессуары\",\n    \"Боди (длинный рукав)\",\n    \"Боди (короткий рукав)\",\n    \"Кофты\",\n    \"Наборы\",\n    \"Песочник\",\n    \"Пижамы\",\n    \"Платья\",\n    \"Регланы\",\n    \"Футболки\",\n    \"Человечки\",\n    \"Шорты\",\n    \"Штаны\",\n  ],\n  boys:[\n    \"Аксессуары\",\n    \"Боди (длинный рукав)\",\n    \"Боди (короткий рукав)\",\n    \"Кофты\",\n    \"Наборы\",\n    \"Песочник\",\n    \"Пижамы\",\n    \"Регланы\",\n    \"Футболки\",\n    \"Человечки\",\n    \"Шорты\",\n    \"Штаны\",\n    ]\n}\n        \n\n\nexport const productNamesToFolders = {\n    \"ДР\":\"Боди (длинный рукав)\",\n    \"КР\":\"Боди (короткий рукав)\",\n    \"Кофт\":\"Кофты\",\n    \"Набор\":\"Наборы\",\n    \"Песочник\":\"Песочник\",\n    \"Пижам\":\"Пижамы\",\n    \"Плать\":\"Платья\",\n    \"Реглан\":\"Регланы\",\n    \"Футболк\":\"Футболки\",\n    \"Человеч\":\"Человечки\",\n    \"Шорты\":\"Шорты\",\n    \"Штаны\": \"Штаны\",\n    \"Лосины\":\"Штаны\",\n    \"Костюм\":\"Наборы\"\n}\nexport const sizes = [\n\"NB\",\n\"0-3\",\n\"1-2\",\n\"2-4\",\n\"3-6\",\n\"4-6\",\n\"6-9\",\n\"9-12\",\n\"12-18\",\n\"18-24\",\n\"24-36\",\n]\n\n","import { productGroups, sizes } from \"../data\"\n\nexport function getSize(name){\n  const re = /([0-9]+)-([0-9]+)|NB/g;\n  return name.match(re)[0];\n}\n\nexport function defineProductsBySex(sex,productGroups){\n  return sex === \"girls\" || sex === \"common\" ? productGroups['girls'] : productGroups['boys']\n}\n\nexport function createDefaultDataSource(sex,initial=\"\"){\n  const products = defineProductsBySex(sex, productGroups)\n  return products.map((product,idx)=>{\n  \n    return {\n      key: idx,\n      name:product,\n      NB: initial,\n      \"0-3\": initial,\n      \"1-2\":initial,\n      \"2-4\":initial,\n      \"3-6\": initial,\n      \"4-6\": initial,\n      \"6-9\": initial,\n      \"9-12\": initial,\n      \"12-18\": initial,\n      \"18-24\": initial,\n      \"24-36\":initial,\n      \"total\":initial,\n      \"sellSum\":initial,\n      \"additionalData\":{\n        sellSum:{}\n      }\n      \n    }\n  })\n}\n\nexport function createColumns(titles){\n    const res = titles.map((title,idx)=>{\n    \n      return {\n        title: title,\n        dataIndex: title,\n        key: idx,\n        render(value, record) {\n        console.log(record)\n          const background = title === \"total\" ? \"white\" : parseInt(value) > 0 ? \"#C7E78F\":\"#e6948e\"\n         let res = record.sellSum && (sizes.indexOf(title)) !== -1 ? value &&`${value} (${((record.additionalData.sellSum[title])*100/record.sellSum).toFixed(2)}%)` : value\n         \n          return {\n            props: {\n              style: { background}\n            },\n            children: <div>{res} </div>\n          };\n        }\n      \n      };\n    })\n    res.unshift(  {\n      title: 'Название',\n      dataIndex: 'name',\n      key: 'name',\n    })\n    return res\n  }\n  \nconst stockTitles = [...sizes,'total']\nconst sellTitles = [...sizes,'total',\"sellSum\"]\n  export const sellColumns = createColumns(sellTitles)\n  export const stockColumns = createColumns(stockTitles)\n","import axios from \"axios\"\nimport moment from 'moment';\nimport { dateFormat } from \"../data\";\n\n\nconst folderLinks = {\n  girls:\"https://online.moysklad.ru/api/remap/1.2/entity/productfolder/c9ac503e-1d16-11eb-0a80-050d002dcd9a\",\n  boys:\"https://online.moysklad.ru/api/remap/1.2/entity/productfolder/00cfa023-1d16-11eb-0a80-050d002dade8\",\n  unisex:\"https://online.moysklad.ru/api/remap/1.2/entity/productfolder/73475072-28e9-11eb-0a80-029000103030\"\n}\naxios.defaults.headers.post[\"Content-Type\"] = \"application/json\";\nconst instance = axios.create({baseURL:\"https://kapri-server.herokuapp.com\"})\n\nexport const fetchStock = async (options) => {\n  const { folderName, inTransit } = options;\n  const stockMode = inTransit ? \"all\" : \"positiveOnly\";\n  const folderFilter = folderName === 'common' ?  \"\" : `&filter=productFolder=${folderLinks[folderName]}`\n  const link = `https://online.moysklad.ru/api/remap/1.2/report/stock/all?groupBy=consignment&filter=stockMode=${stockMode}&filter=inTransitOnly=${inTransit}` + folderFilter\n\n  const result = await instance.post(\"/\", { link });\n    return result.data;\n}\n\nexport const fetchSales = async (\n  counterparty,\n  momentFrom = \"2020-11-01 00:00:00\",\n  momentTo = moment(new Date()).format(dateFormat),\n) => {\n  const counterpartyFilter = !!counterparty ?`&filter=counterparty=${counterparty}` : \"\"\n  const link = `https://online.moysklad.ru/api/remap/1.2/report/profit/byvariant?momentFrom=${momentFrom}&momentTo=${momentTo}` + counterpartyFilter\n\n  const result = await instance.post(\n    '/',{link},\n   \n  );\n  return result.data\n};\n\nexport const fetchCounterparty = async () => {\n  const link = \"https://online.moysklad.ru/api/remap/1.2/report/profit/bycounterparty\"\n  const result = await instance.post(\"/\", { link });\n  return result.data\n}\n\n","import React,{useEffect,useState} from 'react'\nimport {useParams} from 'react-router-dom'\nimport { Table} from 'antd';\nimport { productGroups, } from '../../data'\nimport { createDefaultDataSource, defineProductsBySex } from '../../utils/utils'\nimport {stockColumns,getSize} from '../../utils/utils'\nimport { fetchStock } from '../../core/api';\nimport { Checkbox } from 'antd';\nimport { Menu, Dropdown, Button } from 'antd';\n\n\nfunction createDefaultStock(sex){\n  const products = defineProductsBySex(sex,productGroups)  \n  return products.map((product)=>{\n    return    {\n      name: product,\n      sizes: {\n        \"NB\":{ width: 0, depth: 0,inTransit:0,},\n        \"0-3\": { width: 0, depth: 0,inTransit:0,},\n        \"1-2\": { width: 0, depth: 0,inTransit:0, },\n        \"2-4\": { width: 0, depth: 0,inTransit:0, },\n        \"3-6\": { width: 0, depth: 0 ,inTransit:0,},\n        \"4-6\": { width: 0, depth: 0,inTransit:0,  },\n\n        \"6-9\": { width: 0, depth: 0 ,inTransit:0, },\n        \"9-12\": { width: 0, depth: 0 ,inTransit:0, },\n        \"12-18\": { width: 0, depth: 0 ,inTransit:0, },\n        \"18-24\": { width: 0, depth: 0 ,inTransit:0,},\n        \"24-36\": { width: 0, depth: 0 ,inTransit:0, },\n\n      },\n    }\n  })\n}\n\nconst brands = [\n  \"all\",\n  \"bi baby\",\n  \"bimini\",\n  \"biorganic\",\n  \"Disney baby\",\n  \"DreamKid\",\n  \"Dunnes\",\n  \"H&M\",\n  \"Little Angel\",\n  \"George\",\n  \"little life\",\n  \"Marks & Spencer\",\n  \"Matalan\",\n  \"Next\",\n  \"Tasco\",\n  \"KEHA\",\n  \"Мамине чудо\"\n];\n\n\n\nexport const StockTable = ({fetchFunc}) => {\n  const [dataSource, setDataSource] =useState(null)\n  const [isLoading,setIsLoading] = useState(false)\n  const [inTransit, setInTransit] =  useState(false)\n  const [brand,setBrand] = useState(\"all\")\n  const {sex} = useParams()\n  \n  const menu = \n (\n  <Menu theme=\"dark\" selectedKeys={[brand]}>\n    {brands.map(brand=>{\n      return   (\n      <Menu.Item  onClick ={()=>{setBrand(brand)}} key={brand}>\n        {brand}   \n    </Menu.Item>)\n    })}\n  \n  </Menu>\n);\n\n  const updateDataSource = async () => {\n    const stockData = createDefaultStock(sex);\n    const newDataSource = createDefaultDataSource(sex);\n    setIsLoading(true);\n    const options = { folderName: sex, inTransit };\n    let products = await fetchStock(options);\n\n    if (brand !== \"all\") {\n      products = filterByBrand(products,brand)\n    }\n\n    products.forEach((good) => {\n      const size = getSize(good.name);\n      stockData.forEach((item)  => {\n        if (good.folder.name === item.name && !!item.sizes[size]) {\n          item.sizes[size].width += 1;\n          item.sizes[size].depth += inTransit ? good.inTransit : good.stock;\n        }\n      });\n    });\n    newDataSource.forEach((item) => {\n    \n      const res = stockData.find((el) => item.name === el.name);\n       let totalW = 0\n       let totalD = 0\n      \n       for (let size in res.sizes) {\n         totalW += res.sizes[size].width;\n         totalD += res.sizes[size].depth;\n       }\n      item.total = `${totalD} (${totalW})`\n      for (let size in res.sizes) {\n        item[size] = `${res.sizes[size].depth} (${res.sizes[size].width}) `;\n\n      }\n    });\n\n    setDataSource(newDataSource);\n    setIsLoading(false);\n  };\n\n  useEffect(() => {\n    updateDataSource(fetchFunc);\n  }, [sex, inTransit, brand]);\n  return (\n    <>\n      <Dropdown  overlay={menu} placement=\"bottomCenter\">\n        <Button>Бренд</Button>\n      </Dropdown>\n      <Checkbox style={{\"marginLeft\":\"30px\"}}onChange={() => setInTransit((prev) => !prev)}>\n        In transit\n      </Checkbox>\n      <Table\n        dataSource={dataSource}\n        columns={stockColumns}\n        columnstock=\"3px\"\n        pagination={false}\n        bordered={true}\n        loading={isLoading}\n      />\n    </>\n  );\n}\n\nconst filterByBrand = (products, brand) => {\n return products.filter((product) => {\n    return product.name.indexOf(brand) !== -1;\n  });\n}\n\n","import React,{useEffect,  useState, useRef} from 'react'\nimport { fetchCounterparty, fetchSales } from '../../core/api'\nimport {productNamesToFolders,dateFormat} from '../../data'\nimport { createDefaultDataSource,sellColumns,getSize } from '../../utils/utils'\nimport { DatePicker, Dropdown, Table, Button, Menu } from \"antd\";\nimport moment from 'moment';\nimport { useParams } from 'react-router-dom'\n\nconst mapSexToSymbol = {\n  boys: \"М\",\n  girls: \"Д\",\n  unisex: \"У\",\n};\n\nconst productNames = Object.keys(productNamesToFolders);\n\nconst { RangePicker } = DatePicker;\n\nexport const SalesTable = () => {\n  const { sex } = useParams();\n  const [dataSource, setDataSource] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [counterparty, setCounterparty] = useState(null);\n  const counterparties = useRef([]);\n\n  const counterpartyMenu = (\n    <Menu theme=\"dark\" selectedKeys={[counterparty]}>\n      <Menu.Item\n        onClick={() => {\n          setCounterparty(null);\n        }}\n        key={\"All\"}\n      >\n        {\"All\"}\n      </Menu.Item>\n      {counterparties.current.map((item) => {\n        return (\n          <Menu.Item\n            onClick={() => {\n              setCounterparty(item.counterparty.meta.href);\n            }}\n            key={item.counterparty.name}\n          >\n            {item.counterparty.name}\n          </Menu.Item>\n        );\n      })}\n    </Menu>\n  );\n\n  const updateDataSource = async ( counterparty,momentFrom, momentTo,) => {\n    setIsLoading(true);\n    let products = await fetchSales(counterparty,momentFrom, momentTo);\n     products = sex === \"common\" ? products : filterBySex(products, sex);\n    setDataSource(updateSalesData(productNames, products, sex));\n    setIsLoading(false);\n  };\n\n  useEffect(() => {\n    fetchCounterparty().then((res) => {\n      counterparties.current = res\n    });\n  }, []);\n\n  useEffect(() => {\n    updateDataSource(counterparty);\n  }, [sex,counterparty]);\n  return (\n    <>\n        <RangePicker\n          onChange={(moments) => {\n            updateDataSource(counterparty,\n              moment(moments[0]._d).format(dateFormat),\n              moment(moments[1]._d).format(dateFormat)\n            );\n          }}\n          format={dateFormat}\n          size=\"large\"\n        />\n        <Dropdown overlay={counterpartyMenu}  placement=\"bottomCenter\">\n          <Button>Контрагент</Button>\n        </Dropdown>\n      <Table\n        dataSource={dataSource}\n        columns={sellColumns}\n        columnstock=\"3px\"\n        pagination={false}\n        bordered={true}\n        loading={isLoading}\n      />\n    </>\n  );\n}\n\nfunction checkSex(str,sex){\n    const re = `^[${mapSexToSymbol[sex]}]{1}`;\n    const res = str.match(re);\n    if( res) {\n        return mapSexToSymbol[sex] === res[0];\n    }\n}\n\nfunction filterBySex(products, sex){\n    return products.filter((product) => {\n        return checkSex(product.assortment.name, sex);\n    })\n}\n\nfunction filterByProductName(products,name){\n    return products.filter(\n      (product) => product.assortment.name.indexOf(name) !== -1\n    );\n}\n\nfunction findFolderByProductName(dataSource,name){\n    return  dataSource.find((productFolder) => {\n        return productFolder.name === productNamesToFolders[name];\n      });\n}\nfunction updateSalesData(productNames,products,sex){\n  const dataSource = createDefaultDataSource(sex, 0);\n\n  productNames.forEach((name) => {\n    filterByProductName(products, name).forEach((product) => {\n      const productFolder = findFolderByProductName(dataSource, name);\n      const size = getSize(product.assortment.name);\n      productFolder[size] += product.sellQuantity;\n      productFolder[\"total\"] += product.sellQuantity;\n      productFolder[\"sellSum\"] += Number((product.sellSum / 100).toFixed(0));\n      if (productFolder[\"additionalData\"].sellSum[size]) {\n        productFolder[\"additionalData\"].sellSum[size] += Number(\n          product.sellSum / 100\n        );\n      } else {\n        productFolder[\"additionalData\"].sellSum[size] = Number(\n          product.sellSum / 100\n        );\n      }\n\n      // += Number((product.sellSum / 100))\n\n      // console.log(product.sellQuantity ,product.sellPrice, Number((product.sellSum / 100).toFixed(0))  )\n    });\n  });\n\n  return dataSource;\n}\n","import {StockTable} from './components/SalesTable/StockTable'\nimport React from 'react'\nimport {Route,NavLink} from 'react-router-dom'\n\n\n\nimport { Menu } from 'antd';\nimport { SalesTable } from './components/SalesTable/SalesTable';\n\nconst { SubMenu } = Menu;\n\nclass App extends React.Component {\n  state = {\n    current: 'mail',\n  };\n\n  handleClick = e => {\n    this.setState({ current: e.key });\n  };\n\n  render() {\n    const { current } = this.state;\n    return (\n      <>\n        \n          <Menu\n            onClick={this.handleClick}\n            selectedKeys={[current]}\n            mode=\"horizontal\"\n            theme=\"dark\"\n          >\n            <SubMenu key=\"boys\" title=\"Мальчики\">\n              <Menu.Item key=\"boysStock\">\n                <NavLink to=\"/stock/boys\">Oстатки </NavLink>\n              </Menu.Item>\n              <Menu.Item key=\"boysSales\">\n                <NavLink to=\"/sales/boys\">Продажи </NavLink>\n              </Menu.Item>\n            </SubMenu>\n\n            <SubMenu key=\"girls\" title=\"Девочки\">\n              <Menu.Item key=\"girlsStock\">\n                <NavLink to=\"/stock/girls\">Oстатки </NavLink>\n              </Menu.Item>\n              <Menu.Item key=\"girlsSales\">\n                <NavLink to=\"/sales/girls\">Продажи </NavLink>\n              </Menu.Item>\n            </SubMenu>\n            <SubMenu key=\"unisex\" title=\"Унисекс\">\n              <Menu.Item key=\"unisexStock\">\n                <NavLink to=\"/stock/unisex\">Oстатки</NavLink>\n              </Menu.Item>\n              <Menu.Item key=\"unisexSales\">\n                <NavLink to=\"/sales/unisex\">Продажи</NavLink>\n              </Menu.Item>\n            </SubMenu>\n            <SubMenu key=\"common\" title=\"Общее\">\n              <Menu.Item key=\"commonStock\">\n                <NavLink to=\"/stock/common\">Oстатки</NavLink>\n              </Menu.Item>\n              <Menu.Item key=\"commonSales\">\n                <NavLink to=\"/sales/common\">Продажи</NavLink>\n              </Menu.Item>\n            </SubMenu>\n          </Menu>\n        \n        <Route exact path=\"/stock/:sex\" render={() => <StockTable />} />\n        <Route path=\"/sales/:sex\" render={() => <SalesTable />} />\n      </>\n    );\n  }\n}\nexport default App\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport {HashRouter} from 'react-router-dom'\n\nReactDOM.render(\n    <HashRouter>\n      <App />\n   </HashRouter>,\n  document.getElementById(\"root\")\n);\n\n"],"sourceRoot":""}