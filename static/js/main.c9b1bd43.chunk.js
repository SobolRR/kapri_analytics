(this.webpackJsonpkapri_analytics=this.webpackJsonpkapri_analytics||[]).push([[0],{192:function(t,e,n){},346:function(t,e,n){},347:function(t,e,n){"use strict";n.r(e);var r=n(6),a=n(0),o=n.n(a),c=n(30),i=n.n(c),s=(n(192),n(170)),l=n(171),u=n(185),d=n(182),m=n(21),p=n(22),f=n(71),b=n(35),j=n.n(b),h=n(64),x=n(34),y=n(350),O=n(47),g=n(26),S="YYYY-MM-DD",k={girls:["\u0410\u043a\u0441\u0435\u0441\u0441\u0443\u0430\u0440\u044b","\u0411\u043e\u0434\u0438 (\u0434\u043b\u0438\u043d\u043d\u044b\u0439 \u0440\u0443\u043a\u0430\u0432)","\u0411\u043e\u0434\u0438 (\u043a\u043e\u0440\u043e\u0442\u043a\u0438\u0439 \u0440\u0443\u043a\u0430\u0432)","\u0416\u0438\u043b\u0435\u0442\u043a\u0438/\u043a\u0443\u0440\u0442\u043a\u0438","\u041a\u043e\u0444\u0442\u044b","\u041d\u0430\u0431\u043e\u0440\u044b","\u041d\u043e\u0441\u043e\u0447\u043a\u0438","\u041f\u0435\u0441\u043e\u0447\u043d\u0438\u043a","\u041a\u043e\u043b\u0433\u043e\u0442\u043a\u0438","\u041f\u043e\u043b\u0437\u0443\u043d\u043a\u0438","\u0420\u043e\u043c\u043f\u0435\u0440\u044b","\u041f\u0438\u0436\u0430\u043c\u044b","\u041f\u043b\u0430\u0442\u044c\u044f","\u0420\u0435\u0433\u043b\u0430\u043d\u044b","\u0424\u0443\u0442\u0431\u043e\u043b\u043a\u0438","\u0427\u0435\u043b\u043e\u0432\u0435\u0447\u043a\u0438","\u0428\u043e\u0440\u0442\u044b","\u0428\u0442\u0430\u043d\u044b"],boys:["\u0410\u043a\u0441\u0435\u0441\u0441\u0443\u0430\u0440\u044b","\u0411\u043e\u0434\u0438 (\u0434\u043b\u0438\u043d\u043d\u044b\u0439 \u0440\u0443\u043a\u0430\u0432)","\u0411\u043e\u0434\u0438 (\u043a\u043e\u0440\u043e\u0442\u043a\u0438\u0439 \u0440\u0443\u043a\u0430\u0432)","\u041a\u043e\u0444\u0442\u044b","\u041d\u0430\u0431\u043e\u0440\u044b","\u041d\u043e\u0441\u043e\u0447\u043a\u0438","\u041f\u0435\u0441\u043e\u0447\u043d\u0438\u043a","\u041f\u0438\u0436\u0430\u043c\u044b","\u041f\u043e\u043b\u0437\u0443\u043d\u043a\u0438","\u0420\u043e\u043c\u043f\u0435\u0440\u044b","\u0420\u0435\u0433\u043b\u0430\u043d\u044b","\u0424\u0443\u0442\u0431\u043e\u043b\u043a\u0438","\u0427\u0435\u043b\u043e\u0432\u0435\u0447\u043a\u0438","\u0428\u043e\u0440\u0442\u044b","\u0428\u0442\u0430\u043d\u044b"]},v={"\u0414\u0420":"\u0411\u043e\u0434\u0438 (\u0434\u043b\u0438\u043d\u043d\u044b\u0439 \u0440\u0443\u043a\u0430\u0432)","\u041a\u0420":"\u0411\u043e\u0434\u0438 (\u043a\u043e\u0440\u043e\u0442\u043a\u0438\u0439 \u0440\u0443\u043a\u0430\u0432)","\u041a\u0443\u0440\u0442\u043e\u0447":"\u0416\u0438\u043b\u0435\u0442\u043a\u0438/\u043a\u0443\u0440\u0442\u043a\u0438","\u041a\u043e\u0444\u0442":"\u041a\u043e\u0444\u0442\u044b","\u041d\u0430\u0431\u043e\u0440":"\u041d\u0430\u0431\u043e\u0440\u044b","\u041d\u043e\u0441\u043e\u0447\u043a\u0438":"\u041d\u043e\u0441\u043e\u0447\u043a\u0438","\u041f\u043e\u043b\u0437\u0443\u043d\u043a":"\u041f\u043e\u043b\u0437\u0443\u043d\u043a\u0438","\u0420\u043e\u043c\u043f\u0435\u0440":"\u0420\u043e\u043c\u043f\u0435\u0440\u044b","\u041a\u043e\u043b\u0433\u043e\u0442":"\u041a\u043e\u043b\u0433\u043e\u0442\u043a\u0438","\u041f\u0435\u0441\u043e\u0447\u043d\u0438\u043a":"\u041f\u0435\u0441\u043e\u0447\u043d\u0438\u043a","\u041f\u0438\u0436\u0430\u043c":"\u041f\u0438\u0436\u0430\u043c\u044b","\u041f\u043b\u0430\u0442\u044c":"\u041f\u043b\u0430\u0442\u044c\u044f","\u0420\u0435\u0433\u043b\u0430\u043d":"\u0420\u0435\u0433\u043b\u0430\u043d\u044b","\u0424\u0443\u0442\u0431\u043e\u043b\u043a":"\u0424\u0443\u0442\u0431\u043e\u043b\u043a\u0438","\u0427\u0435\u043b\u043e\u0432\u0435\u0447":"\u0427\u0435\u043b\u043e\u0432\u0435\u0447\u043a\u0438","\u0428\u043e\u0440\u0442\u044b":"\u0428\u043e\u0440\u0442\u044b","\u0428\u0442\u0430\u043d\u044b":"\u0428\u0442\u0430\u043d\u044b","\u041b\u043e\u0441\u0438\u043d\u044b":"\u0428\u0442\u0430\u043d\u044b","\u041a\u043e\u0441\u0442\u044e\u043c":"\u041d\u0430\u0431\u043e\u0440\u044b"},C={"\u0411\u043e\u0434\u0438 (\u0434\u043b\u0438\u043d\u043d\u044b\u0439 \u0440\u0443\u043a\u0430\u0432)":"\u0414\u0420","\u0411\u043e\u0434\u0438 (\u043a\u043e\u0440\u043e\u0442\u043a\u0438\u0439 \u0440\u0443\u043a\u0430\u0432)":"\u041a\u0420","\u0416\u0438\u043b\u0435\u0442\u043a\u0438/\u043a\u0443\u0440\u0442\u043a\u0438":"\u041a\u0443\u0440\u0442\u043e\u0447","\u041a\u043e\u0444\u0442\u044b":"\u041a\u043e\u0444\u0442","\u041d\u0430\u0431\u043e\u0440\u044b":["\u041d\u0430\u0431\u043e\u0440","\u041a\u043e\u0441\u0442\u044e\u043c"],"\u041d\u043e\u0441\u043e\u0447\u043a\u0438":"\u041d\u043e\u0441\u043e\u0447\u043a\u0438","\u041f\u0435\u0441\u043e\u0447\u043d\u0438\u043a":"\u041f\u0435\u0441\u043e\u0447\u043d\u0438\u043a","\u041f\u0438\u0436\u0430\u043c\u044b":"\u041f\u0438\u0436\u0430\u043c","\u041f\u043b\u0430\u0442\u044c\u044f":"\u041f\u043b\u0430\u0442\u044c","\u0420\u0435\u0433\u043b\u0430\u043d\u044b":"\u0420\u0435\u0433\u043b\u0430\u043d","\u0424\u0443\u0442\u0431\u043e\u043b\u043a\u0438":"\u0424\u0443\u0442\u0431\u043e\u043b\u043a","\u0427\u0435\u043b\u043e\u0432\u0435\u0447\u043a\u0438":"\u0427\u0435\u043b\u043e\u0432\u0435\u0447","\u0428\u043e\u0440\u0442\u044b":"\u0428\u043e\u0440\u0442\u044b","\u0428\u0442\u0430\u043d\u044b":["\u0428\u0442\u0430\u043d\u044b","\u041b\u043e\u0441\u0438\u043d\u044b"],"\u041f\u043e\u043b\u0437\u0443\u043d\u043a\u0438":"\u041f\u043e\u043b\u0437\u0443\u043d\u043a","\u0420\u043e\u043c\u043f\u0435\u0440\u044b":"\u0420\u043e\u043c\u043f\u0435\u0440","\u041a\u043e\u043b\u0433\u043e\u0442\u043a\u0438":"\u041a\u043e\u043b\u0433\u043e\u0442"},I=["NB","0-3","0-6","1-2","2-4","3-6","4-6","6-9","6-12","9-12","12-18","18-24","24-36"],F=["all","bi baby","bimini","biorganic","Caramell","Disney baby","DreamKid","Dunnes","H&M","Little Angel","George","little life","Marks & Spencer","Matalan","Next","Tesco","KEHA","\u041c\u0430\u043c\u0438\u043d\u0435 \u0447\u0443\u0434\u043e"];function B(t){return t.match(/([0-9]+)-([0-9]+)|NB/g)[0]}function w(t,e){return"girls"===t||"common"===t?e.girls:e.boys}function T(t,e,n,r){switch(t){case"sales":return-1!==I.indexOf(e)?r&&"".concat(n.showSellSum?n.additionalData.sellSum[e]:r," (").concat((100*n.additionalData.sellSum[e]/n.totalSellSum).toFixed(2),"%)"):r;default:return r}}var D=function(t,e){var n=t.name.toLowerCase(),r=e.name.toLowerCase();return n<r?-1:n>r?1:0};var E={brandsReport:function(t){return function(e,n){return parseFloat(e[t])-parseFloat(n[t])}},sales:function(t){return function(e,n){return parseInt(e[t])-parseInt(n[t])}}};function z(t,e){var n=t.map((function(t,n){var a=E[e]&&-1===I.indexOf(t)?{sorter:E[e](t)}:{};return Object(g.a)(Object(g.a)({title:t,dataIndex:t,key:n},a),{},{render:function(n,a){return{props:{style:{background:function(t,e){return"total"===t?"white":parseInt(e)>0?"#C7E78F":"#e6948e"}(t,n)}},children:Object(r.jsxs)("div",{children:[T(e,t,a,n)," "]})}}})}));return n.unshift({title:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",dataIndex:"name",key:"name",sorter:D,width:200}),n}var R=[].concat(Object(O.a)(I),["total"]),M=z([].concat(Object(O.a)(I),["total","totalSellSum"]),"sales"),Q=z(R,"stock"),N=z(["sum","profit","profitability"],"brandsReport"),A=(z(["salesCount","profit","salesAvgCheck","sellSum"],"counterpartiesReport"),n(130)),L=n.n(A),K={girls:"https://online.moysklad.ru/api/remap/1.2/entity/productfolder/c9ac503e-1d16-11eb-0a80-050d002dcd9a",boys:"https://online.moysklad.ru/api/remap/1.2/entity/productfolder/00cfa023-1d16-11eb-0a80-050d002dade8",unisex:"https://online.moysklad.ru/api/remap/1.2/entity/productfolder/73475072-28e9-11eb-0a80-029000103030"};L.a.defaults.headers.post["Content-Type"]="application/json";var P=L.a.create({baseURL:"https://kapri-server.herokuapp.com"}),Y=function(){var t=Object(h.a)(j.a.mark((function t(e){var n,r,a,o,c,i;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.folderName,r=e.inTransit,a=r?"all":"positiveOnly",o="common"===n?"":"&filter=productFolder=".concat(K[n]),c="https://online.moysklad.ru/api/remap/1.2/report/stock/all?groupBy=consignment&filter=stockMode=".concat(a,"&filter=inTransitOnly=").concat(r)+o,t.next=6,P.post("/",{link:c});case 6:return i=t.sent,t.abrupt("return",i.data);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),_=function(){var t=Object(h.a)(j.a.mark((function t(e,n,r){var a,o,c;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e&&"All"!==e?"&filter=counterparty=".concat(e):"",o="https://online.moysklad.ru/api/remap/1.2/report/profit/byvariant?momentFrom=".concat(n," 00:00:00&momentTo=").concat(r," 23:59:59")+a,t.next=4,P.post("/",{link:o});case 4:return c=t.sent,t.abrupt("return",c.data);case 6:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),U=function(){var t=Object(h.a)(j.a.mark((function t(){var e;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"https://online.moysklad.ru/api/remap/1.2/report/profit/bycounterparty",t.next=3,P.post("/",{link:"https://online.moysklad.ru/api/remap/1.2/report/profit/bycounterparty"});case 3:return e=t.sent,t.abrupt("return",e.data);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),G=n(92),H=n(67);var J=function(t,e){return t.filter((function(t){return-1!==t.name.indexOf(e)}))};function q(t,e,n){var r=function(t){return w(t,k).map((function(t){return{name:t,sizes:I.reduce((function(t,e){return Object(g.a)(Object(g.a)({},t),{},Object(H.a)({},e,{width:0,depth:0,inTransit:0}))}),{})}}))}(e);return t.forEach((function(t){var e=B(t.name);r.forEach((function(r){t.folder.name===r.name&&r.sizes[e]&&(r.sizes[e].width+=1,r.sizes[e].depth+=n?t.inTransit:t.stock)}))})),r}function V(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=w(t,k),r=I.reduce((function(t,n){return Object(g.a)(Object(g.a)({},t),{},Object(H.a)({},n,e))}),{});return n.map((function(t,n){return Object(g.a)(Object(g.a)({key:n,name:t,NB:e},r),{},{total:e})}))}var W=function(t){var e=t.currentBrand,n=(t.loading,Object(a.useState)(null)),o=Object(x.a)(n,2),c=o[0],i=o[1],s=Object(a.useState)(!1),l=Object(x.a)(s,2),u=l[0],d=l[1],m=Object(a.useState)(!1),f=Object(x.a)(m,2),b=f[0],O=f[1],g=Object(p.e)().sex,S=function(){var t=Object(h.a)(j.a.mark((function t(){var n,r,a,o;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=V(g),d(!0),r={folderName:g,inTransit:b},t.next=5,Y(r);case 5:a=t.sent,"all"!==e&&(a=J(a,e)),o=q(a,g,b),n.forEach((function(t){var e=o.find((function(e){return t.name===e.name})),n=0,r=0;for(var a in e.sizes)n+=e.sizes[a].width,r+=e.sizes[a].depth,t[a]="".concat(e.sizes[a].depth," (").concat(e.sizes[a].width,") ");t.total="".concat(r," (").concat(n,")")})),i(n),d(!1);case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(a.useEffect)((function(){S()}),[g,b,e]),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(G.a,{style:{marginLeft:"30px"},onChange:function(){return O((function(t){return!t}))},children:"In transit"}),Object(r.jsx)(y.a,{dataSource:c,style:{marginTop:"4vh"},columns:Q,columnstock:"3px",pagination:!1,bordered:!0,loading:u})]})},X={boys:"\u041c",girls:"\u0414",unisex:"\u0423"};function Z(t,e){return"common"===e?t:t.filter((function(t){return function(t,e){var n="^[".concat(X[e],"]{1}"),r=t.match(n);if(r)return X[e]===r[0]}(t.assortment.name,e)}))}function $(t,e){var n=[],r=function(t){return function(e){return-1!==e.assortment.name.indexOf(t)}};return e instanceof Array&&e.length>0?e.forEach((function(e){n.push.apply(n,Object(O.a)(t.filter(r(e))))})):n.push.apply(n,Object(O.a)(t.filter(r(e)))),n}function tt(t,e,n){var r=Object(O.a)(t);return e.forEach((function(t){$(n,[t]).forEach((function(e){var n=function(t,e){return t.find((function(t){return t.name===v[e]}))}(r,t),a=B(e.assortment.name);n[a]+=e.sellQuantity,n.total+=e.sellQuantity,n.sellSum=+e.sellSum,n.totalSellSum+=Number((e.sellSum/100).toFixed(0)),function(t,e,n){var r=t.additionalData.sellSum[n],a=(e.sellSum/100).toFixed(0);r?t.additionalData.sellSum[n]+=Number(a):t.additionalData.sellSum[n]=Number(a)}(n,e,a)}))})),r}var et=n(128),nt=n.n(et);function rt(t){return t.map((function(t,e){return{key:e,name:t,sum:0,profit:0,sellCostSum:0,profitability:0}}))}var at=function(t){return t.map((function(t){var e=+(100*t.profit/t.sellCostSum).toFixed(2);return Object(g.a)(Object(g.a)({},t),{},{sum:(t.sum/100).toFixed(2),profit:(t.profit/100).toFixed(2),profitability:e?e+"%":0})}))},ot=function(t,e,n){var r=Object(O.a)(t);return n>-1&&(r[n]=Object(g.a)(Object(g.a)({},r[n]),{},{sum:r[n].sum+=+e.sellSum,profit:r[n].profit+=+e.profit,sellCostSum:r[n].sellCostSum+=+e.sellCostSum})),r},ct=function(t,e){return"all"!==e?t.filter((function(t){return t.assortment.name.includes(e)})):t},it=Object.keys(v),st=function(t){var e=t.salesData,n=t.currentCounterparty,o=t.currentBrand,c=t.loading,i=Object(p.e)().sex,s=Object(a.useState)(null),l=Object(x.a)(s,2),u=l[0],d=l[1],m=Object(a.useState)(!0),f=Object(x.a)(m,2),b=f[0],j=f[1],h=function(t,e){var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=w(t,k),a=I.reduce((function(t,n){return Object(g.a)(Object(g.a)({},t),{},Object(H.a)({},n,e))}),{});return r.map((function(t,r){return Object(g.a)(Object(g.a)({key:r,name:t,NB:e},a),{},{total:e,totalSellSum:e,additionalData:{sellSum:{}},showSellSum:n})}))}(i,0,b),r=Z(t,i);r=ct(r,e),n=tt(n,it,r),d(n)};return Object(a.useEffect)((function(){h(e,o)}),[i,n,b,e,o]),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(nt.a,{checked:b,style:{marginLeft:"30px"},onChange:function(){return j((function(t){return!t}))},children:"SellSum"}),Object(r.jsx)(y.a,{dataSource:u,columns:M,columnstock:"3px",pagination:!1,bordered:!0,loading:c})]})},lt={brands:F.slice(1),sizes:I,productFolders:k.girls},ut=function(t){var e=t.salesData,n=void 0===e?[]:e,o=t.currentBrand,c=t.loading,i=Object(p.e)().sex,s=Object(p.e)().reportBy,l=Object(a.useState)(rt(lt[s])),u=Object(x.a)(l,2),d=u[0],m=u[1],f=function(){var t=Object(h.a)(j.a.mark((function t(e){var n,r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Z(e,i),"brands"!==s&&(n=ct(n,o)),r=rt(lt[s]),t.t0=s,t.next="brands"===t.t0?6:"sizes"===t.t0?8:"productFolders"===t.t0?10:12;break;case 6:return F.forEach((function(t){ct(n,t).forEach((function(e){var n=r.findIndex((function(e){return e.name===t}));r=ot(r,e,n)}))})),t.abrupt("break",12);case 8:return n.forEach((function(t){var e=d.findIndex((function(e){return e.name===B(t.assortment.name)}));r=ot(r,t,e)})),t.abrupt("break",12);case 10:return r.forEach((function(t,e){$(n,C[t.name]).forEach((function(t){r=ot(r,t,e)}))})),t.abrupt("break",12);case 12:m(at(r));case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(a.useEffect)((function(){f(n)}),[i,s,o,n]),Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(y.a,{style:{width:"70vw"},dataSource:d,columns:N,columnstock:"3px",pagination:!1,bordered:!0,loading:c})})},dt={"\u041c":"boys","\u0414":"girls","\u0423":"unisex"},mt=function(){return k.girls.map((function(t,e){return{key:e,name:t,categories:{girls:{sellQuantity:0,sellSum:0,profit:0,profitability:0,sellCostSum:0},boys:{sellQuantity:0,sellSum:0,profit:0,profitability:0,sellCostSum:0},unisex:{sellQuantity:0,sellSum:0,profit:0,profitability:0,sellCostSum:0},total:{sellQuantity:0,sellSum:0,profit:0,profitability:0,sellCostSum:0}}}}))},pt=[{title:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f \u0442\u043e\u0432\u0430\u0440\u043e\u0432",dataIndex:"name",key:"name",width:100,fixed:"left"},{title:"Girls",children:[{title:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e",dataIndex:["categories","girls","sellQuantity"],key:"sellQuantity"},{title:"\u0421\u0443\u043c\u043c\u0430, \u0433\u0440\u043d",dataIndex:["categories","girls","sellSum"],key:"sellSum"},{title:"\u041f\u0440\u0438\u0431\u044b\u043b\u044c, \u0433\u0440\u043d",dataIndex:["categories","girls","profit"],key:"profit"},{title:"\u0420\u0435\u043d\u0442\u0430\u0431\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c, %",dataIndex:["categories","girls","profitability"],key:"profitability"}]},{title:"Boys",children:[{title:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e",dataIndex:["categories","boys","sellQuantity"],key:"sellQuantity"},{title:"\u0421\u0443\u043c\u043c\u0430, \u0433\u0440\u043d",dataIndex:["categories","boys","sellSum"],key:"sellSum"},{title:"\u041f\u0440\u0438\u0431\u044b\u043b\u044c, \u0433\u0440\u043d",dataIndex:["categories","boys","profit"],key:"profit"},{title:"\u0420\u0435\u043d\u0442\u0430\u0431\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c, %",dataIndex:["categories","boys","profitability"],key:"profitability"}]},{title:"Unisex",children:[{title:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e",dataIndex:["categories","unisex","sellQuantity"],key:"sellQuantity"},{title:"\u0421\u0443\u043c\u043c\u0430, \u0433\u0440\u043d",dataIndex:["categories","unisex","sellSum"],key:"sellSum"},{title:"\u041f\u0440\u0438\u0431\u044b\u043b\u044c, \u0433\u0440\u043d",dataIndex:["categories","unisex","profit"],key:"profit"},{title:"\u0420\u0435\u043d\u0442\u0430\u0431\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c, %",dataIndex:["categories","unisex","profitability"],key:"profitability"}]},{title:"Total",children:[{title:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e",dataIndex:["categories","total","sellQuantity"],key:"sellQuantity"},{title:"\u0421\u0443\u043c\u043c\u0430, \u0433\u0440\u043d",dataIndex:["categories","total","sellSum"],key:"sellSum"},{title:"\u041f\u0440\u0438\u0431\u044b\u043b\u044c, \u0433\u0440\u043d",dataIndex:["categories","total","profit"],key:"profit"},{title:"\u0420\u0435\u043d\u0442\u0430\u0431\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c, %",dataIndex:["categories","total","profitability"],key:"profitability"}]}],ft={salesCount:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0440\u043e\u0434\u0430\u0436",profit:"\u041f\u0440\u0438\u0431\u044b\u043b\u044c",salesAvgCheck:"\u0421\u0440\u0435\u0434\u043d\u0438\u0439 \u0447\u0435\u043a",sellSum:"\u041e\u0431\u044a\u0435\u043c \u043f\u0440\u043e\u0434\u0430\u0436",sellCostSum:"\u0421\u0435\u0431\u0435\u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c",profitability:"\u0420\u0435\u043d\u0442\u0430\u0431\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c"};function bt(t,e){return t.map((function(t){var n=e.reduce((function(t,e){return t[e]=0,t}),{});return Object(g.a)({key:t,name:t},n)}))}var jt=["\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0440\u043e\u0434\u0430\u0436","\u041f\u0440\u0438\u0431\u044b\u043b\u044c","\u0421\u0440\u0435\u0434\u043d\u0438\u0439 \u0447\u0435\u043a","\u041e\u0431\u044a\u0435\u043c \u043f\u0440\u043e\u0434\u0430\u0436","\u0421\u0435\u0431\u0435\u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c","\u0420\u0435\u043d\u0442\u0430\u0431\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c"],ht=function(t){var e=Object(a.useMemo)((function(){return[].concat(Object(O.a)(t.counterparties.map((function(t){return t.counterparty.name}))),["total"])}),[t.counterparties]),n=Object(a.useMemo)((function(){return z(e,"counterpartiesReport")}),[t.counterparties]),o=Object(a.useState)(bt(jt,e)),c=Object(x.a)(o,2),i=c[0],s=c[1];function l(t,e){var n=bt(jt,e);!function(t,e){e.forEach((function(e){var n=function(n){t.some((function(t){return t.name===ft[n]}))&&(t.find((function(t){return t.name===ft[n]}))[e.counterparty.name]="salesCount"!==n?+(parseInt(e[n])/100).toFixed(0):e[n])};for(var r in e)n(r)}))}(n,t),function(t,e){t.forEach((function(t){t.total=e.reduce((function(e,n){return e+t[n]}),0)}))}(n,e),function(t,e){var n=t.find((function(t){return"\u0420\u0435\u043d\u0442\u0430\u0431\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c"===t.name}));e.forEach((function(e){var r=t.find((function(t){return"\u0421\u0435\u0431\u0435\u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c"===t.name})),a=t.find((function(t){return"\u041f\u0440\u0438\u0431\u044b\u043b\u044c"===t.name}));n[e]=+(100*a[e]/r[e]).toFixed(2)+"%"}))}(n,e),s(n)}return Object(a.useEffect)((function(){l(t.counterparties,e)}),[t.counterparties,e]),Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(y.a,{style:{width:"70vw",marginTop:"1vh"},dataSource:i,columns:n,size:"small",columnstock:"3px",pagination:!1,bordered:!0,loading:t.loading})})},xt=function(t){var e=t.momentFrom,n=t.momentTo,o=t.counterparties,c=t.salesData,i=t.loading,s=t.currentBrand,l=Object(a.useState)(mt()),u=Object(x.a)(l,2),d=u[0],m=u[1];function p(t,e){var n=mt();n.forEach((function(n){var r=n.categories,a=r.total,o=$(t,C[n.name]);"all"!==e&&(o=ct(o,e)),o.forEach((function(t){var e,n=(e=t.assortment.name,dt[e[0]]);r[n].sellQuantity+=+t.sellQuantity,r[n].sellSum+=+t.sellSum,r[n].profit+=+t.profit,r[n].sellCostSum+=+t.sellCostSum,a.sellQuantity+=+t.sellQuantity,a.sellSum+=+t.sellSum,a.profit+=+t.profit,a.sellCostSum+=+t.sellCostSum}))})),n.forEach((function(t){var e=t.categories;for(var n in t.categories){var r=!!t.categories[n].sellCostSum&&+(100*t.categories[n].profit/t.categories[n].sellCostSum).toFixed(2);e[n].sellSum=+(parseInt(e[n].sellSum)/100).toFixed(2),e[n].profit=+(parseInt(e[n].profit)/100).toFixed(2),e[n].profitability=r?r+"%":0}})),m(n)}return Object(a.useEffect)((function(){p(c,s)}),[n,e,c,s]),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(y.a,{style:{width:"70vw"},dataSource:d,columns:pt,size:"small",columnstock:"3px",pagination:!1,bordered:!0,loading:i}),Object(r.jsx)(ht,{counterparties:o,loading:!o.length})]})},yt=n(351),Ot=n(108),gt=n(57),St=n(39),kt=n.n(St),vt=(n(346),yt.a.RangePicker),Ct=function(t){var e=t.counterparties,n=t.currentCounterparty,o=t.currentBrand,c=t.handleBrandChange,i=t.handleCounterpartyChange,s=t.handleMomentFromChange,l=t.handleMomentToChange;return Object(a.useEffect)((function(){return function(){c("all")}}),[]),Object(r.jsxs)("div",{className:"filter",children:[Object(r.jsx)(p.a,{path:["/sales/:sex"],children:Object(r.jsx)(Ot.a,{overlay:Ft(e,n,i),children:Object(r.jsx)(gt.a,{children:n?n.counterparty.name:"Counterparty"})})}),Object(r.jsx)(p.a,{path:["/report/:sex/sizes","/report/:sex/productFolders","/sales/:sex","/stock/:sex","/report/commonReport"],children:Object(r.jsx)(Ot.a,{overlay:It(F,o,c),children:Object(r.jsx)(gt.a,{children:"all"!==o?o:"Brand"})})}),Object(r.jsx)(p.a,{path:["/report/:sex/:reportBy","/sales/:sex","/report/commonReport"],render:function(){return Object(r.jsx)(vt,{onChange:function(t){s(kt()(t[0]._d).format(S)),l(kt()(t[1]._d).format(S))},format:S,size:"large"})}})]})},It=function(t,e,n){return Object(r.jsx)(f.a,{theme:"dark",selectedKeys:[e],children:t.map((function(t){return Object(r.jsx)(f.a.Item,{onClick:function(){n(t)},children:t},t)}))})},Ft=function(t,e,n){return Object(r.jsxs)(f.a,{theme:"dark",selectedKeys:[e?e.counterparty.name:"All"],children:[Object(r.jsx)(f.a.Item,{onClick:function(){n(null)},children:"All"},"All"),t.map((function(t){return Object(r.jsx)(f.a.Item,{onClick:function(){n(t)},children:t.counterparty.name},t.counterparty.name)}))]})},Bt=f.a.SubMenu,wt=function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(){var t;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))).state={current:null,counterparties:[],currentCounterparty:null,momentFrom:"2021-02-15",momentTo:kt()(new Date).format(S),currentBrand:"all",loading:!0,salesData:[]},t.componentDidMount=function(){var e=t.state,n=e.currentCounterparty,r=e.momentFrom,a=e.momentTo;t.setState({loading:!0}),U().then((function(e){return t.setState({counterparties:e})})).then((function(){_(n,r,a).then((function(e){return t.setState({salesData:e,loading:!1})}))}))},t.componentDidUpdate=function(e,n){var r=t.state,a=r.currentCounterparty,o=r.momentFrom,c=r.momentTo,i=a?a.counterparty.meta.href:a;n.currentCounterparty===a&&n.momentTo===c&&n.momentFrom===o||(t.setState({loading:!0}),_(i,o,c).then((function(e){return t.setState({salesData:e,loading:!1})})))},t.handleClick=function(e){t.setState({current:e.key})},t.handleMomentFromChange=function(e){t.setState({momentFrom:e})},t.handleMomentToChange=function(e){t.setState({momentTo:e})},t.handleBrandChange=function(e){t.setState({currentBrand:e})},t.handleCounterpartyChange=function(e){return t.setState({currentCounterparty:e})},t}return Object(l.a)(n,[{key:"render",value:function(){var t=this,e=this.state.current;return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(f.a,{onClick:this.handleClick,selectedKeys:[e],mode:"horizontal",theme:"dark",style:{position:"sticky",top:"0",zIndex:"1000"},children:[Object(r.jsxs)(Bt,{title:"\u041c\u0430\u043b\u044c\u0447\u0438\u043a\u0438",children:[Object(r.jsx)(f.a.Item,{children:Object(r.jsx)(m.b,{to:"/stock/boys",children:"O\u0441\u0442\u0430\u0442\u043a\u0438 "})},"boysStock"),Object(r.jsx)(f.a.Item,{children:Object(r.jsx)(m.b,{to:"/sales/boys",children:"\u041f\u0440\u043e\u0434\u0430\u0436\u0438 "})},"boysSales"),Object(r.jsx)(f.a.Item,{children:Object(r.jsx)(m.b,{to:"/report/boys/brands",children:"\u041e\u0442\u0447\u0435\u0442 \u043f\u043e \u0431\u0440\u0435\u043d\u0434\u0430\u043c "})},"boysBrandReport"),Object(r.jsx)(f.a.Item,{children:Object(r.jsx)(m.b,{to:"/report/boys/sizes",children:"\u041e\u0442\u0447\u0435\u0442 \u043f\u043e \u0440\u0430\u0437\u043c\u0435\u0440\u0430\u043c "})},"boysSizesReport"),Object(r.jsx)(f.a.Item,{children:Object(r.jsx)(m.b,{to:"/report/boys/productFolders",children:"\u041e\u0442\u0447\u0435\u0442 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f\u043c \u0442\u043e\u0432\u0430\u0440\u043e\u0432 "})},"boysProductFolderReport")]},"boys"),Object(r.jsxs)(Bt,{title:"\u0414\u0435\u0432\u043e\u0447\u043a\u0438",children:[Object(r.jsx)(f.a.Item,{children:Object(r.jsx)(m.b,{to:"/stock/girls",children:"O\u0441\u0442\u0430\u0442\u043a\u0438 "})},"girlsStock"),Object(r.jsx)(f.a.Item,{children:Object(r.jsx)(m.b,{to:"/sales/girls",children:"\u041f\u0440\u043e\u0434\u0430\u0436\u0438 "})},"girlsSales"),Object(r.jsx)(f.a.Item,{children:Object(r.jsx)(m.b,{to:"/report/girls/brands",children:"\u041e\u0442\u0447\u0435\u0442 \u043f\u043e \u0431\u0440\u0435\u043d\u0434\u0430\u043c "})},"girlsBrandReport"),Object(r.jsx)(f.a.Item,{children:Object(r.jsx)(m.b,{to:"/report/girls/sizes",children:"\u041e\u0442\u0447\u0435\u0442 \u043f\u043e \u0440\u0430\u0437\u043c\u0435\u0440\u0430\u043c "})},"girlsSizesReport"),Object(r.jsx)(f.a.Item,{children:Object(r.jsx)(m.b,{to:"/report/girls/productFolders",children:"\u041e\u0442\u0447\u0435\u0442 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f\u043c \u0442\u043e\u0432\u0430\u0440\u043e\u0432 "})},"girlsProductFolderReport")]},"girls"),Object(r.jsxs)(Bt,{title:"\u0423\u043d\u0438\u0441\u0435\u043a\u0441",children:[Object(r.jsx)(f.a.Item,{children:Object(r.jsx)(m.b,{to:"/stock/unisex",children:"O\u0441\u0442\u0430\u0442\u043a\u0438"})},"unisexStock"),Object(r.jsx)(f.a.Item,{children:Object(r.jsx)(m.b,{to:"/sales/unisex",children:"\u041f\u0440\u043e\u0434\u0430\u0436\u0438"})},"unisexSales"),Object(r.jsx)(f.a.Item,{children:Object(r.jsx)(m.b,{to:"/report/unisex/brands",children:"\u041e\u0442\u0447\u0435\u0442 \u043f\u043e \u0431\u0440\u0435\u043d\u0434\u0430\u043c "})},"unisexBrandReport"),Object(r.jsx)(f.a.Item,{children:Object(r.jsx)(m.b,{to:"/report/unisex/sizes",children:"\u041e\u0442\u0447\u0435\u0442 \u043f\u043e \u0440\u0430\u0437\u043c\u0435\u0440\u0430\u043c "})},"unisexSizesReport"),Object(r.jsx)(f.a.Item,{children:Object(r.jsx)(m.b,{to:"/report/unisex/productFolders",children:"\u041e\u0442\u0447\u0435\u0442 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f\u043c \u0442\u043e\u0432\u0430\u0440\u043e\u0432 "})},"unisexProductFolderReport")]},"unisex"),Object(r.jsxs)(Bt,{title:"\u041e\u0431\u0449\u0435\u0435",children:[Object(r.jsx)(f.a.Item,{children:Object(r.jsx)(m.b,{to:"/stock/common",children:"O\u0441\u0442\u0430\u0442\u043a\u0438"})},"commonStock"),Object(r.jsx)(f.a.Item,{children:Object(r.jsx)(m.b,{to:"/sales/common",children:"\u041f\u0440\u043e\u0434\u0430\u0436\u0438"})},"commonSales"),Object(r.jsx)(f.a.Item,{children:Object(r.jsx)(m.b,{to:"/report/common/brands",children:"\u041e\u0442\u0447\u0435\u0442 \u043f\u043e \u0431\u0440\u0435\u043d\u0434\u0430\u043c "})},"commonBrandReport"),Object(r.jsx)(f.a.Item,{children:Object(r.jsx)(m.b,{to:"/report/common/sizes",children:"\u041e\u0442\u0447\u0435\u0442 \u043f\u043e \u0440\u0430\u0437\u043c\u0435\u0440\u0430\u043c "})},"commonSizesReport"),Object(r.jsx)(f.a.Item,{children:Object(r.jsx)(m.b,{to:"/report/common/productFolders",children:"\u041e\u0442\u0447\u0435\u0442 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f\u043c \u0442\u043e\u0432\u0430\u0440\u043e\u0432 "})},"cpmmonProductFolderReport"),Object(r.jsx)(f.a.Item,{children:Object(r.jsx)(m.b,{to:"/report/commonReport/",children:"\u041e\u0431\u0449\u0438\u0439 \u043e\u0442\u0447\u0435\u0442"})},"commonReport")]},"common")]}),Object(r.jsx)(Ct,{counterparties:this.state.counterparties,currentCounterparty:this.state.currentCounterparty,currentBrand:this.state.currentBrand,handleBrandChange:this.handleBrandChange,handleCounterpartyChange:this.handleCounterpartyChange,handleMomentFromChange:this.handleMomentFromChange,handleMomentToChange:this.handleMomentToChange}),Object(r.jsx)(p.a,{exact:!0,path:"/stock/:sex",render:function(){return Object(r.jsx)(W,{currentBrand:t.state.currentBrand})}}),Object(r.jsx)(p.a,{path:"/sales/:sex",render:function(){return Object(r.jsx)(st,{salesData:t.state.salesData,momentFrom:t.state.momentFrom,momentTo:t.state.momentTo,counterparties:t.state.counterparties,loading:t.state.loading,currentCounterparty:t.state.currentCounterparty,currentBrand:t.state.currentBrand,onCounterpartyChange:t.handleCounterpartyChange})}}),Object(r.jsx)(p.a,{path:"/report/:sex/:reportBy",render:function(){return Object(r.jsx)(ut,{salesData:t.state.salesData,momentFrom:t.state.momentFrom,momentTo:t.state.momentTo,currentBrand:t.state.currentBrand,loading:t.state.loading,onBrandChange:t.handleBrandChange})}}),Object(r.jsx)(p.a,{path:"/report/commonReport",render:function(){return Object(r.jsx)(xt,{salesData:t.state.salesData,momentFrom:t.state.momentFrom,momentTo:t.state.momentTo,counterparties:t.state.counterparties,currentBrand:t.state.currentBrand,loading:t.state.loading})}})]})}}]),n}(o.a.Component);i.a.render(Object(r.jsx)(m.a,{children:Object(r.jsx)(wt,{})}),document.getElementById("root"))}},[[347,1,2]]]);
//# sourceMappingURL=main.c9b1bd43.chunk.js.map